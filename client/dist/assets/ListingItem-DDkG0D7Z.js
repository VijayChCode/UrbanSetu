import{v as j,r as h,a as y,u as v,b as w,j as t,M as I,l as $,L as g}from"./index-crh2KQ3K.js";import{M as L}from"./index-DDjDdRay.js";import{m as k}from"./addressMasking-3vIUwCOC.js";function C({listing:e,onDelete:l}){const{addToWishlist:u,removeFromWishlist:f,isInWishlist:i}=j(),[a,o]=h.useState(!1),c=y(),p=v(),{currentUser:d}=w(r=>r.user),x=p.pathname.includes("/admin");h.useEffect(()=>{o(i(e._id))},[i,e._id]);const b=async()=>{if(!d){c("/sign-in");return}a?(await f(e._id),o(!1)):(await u(e),o(!0))},N=()=>{if(!d){c("/sign-in");return}const r=x?`/admin/appointmentlisting?listingId=${e._id}&propertyName=${encodeURIComponent(e.name)}&propertyDescription=${encodeURIComponent(e.description)}`:`/user/appointment?listingId=${e._id}&propertyName=${encodeURIComponent(e.name)}&propertyDescription=${encodeURIComponent(e.description)}`;c(r)},n=r=>`₹${Number(r).toLocaleString("en-IN")}`,s=()=>e.offer&&e.regularPrice&&e.discountPrice?Math.round((e.regularPrice-e.discountPrice)/e.regularPrice*100):0;let m=`/listing/${e._id}`;return x?m=`/admin/listing/${e._id}`:p.pathname.startsWith("/user")&&(m=`/user/listing/${e._id}`),t.jsxs("div",{className:"relative bg-white shadow-md rounded-lg overflow-hidden p-4",children:[e.offer&&s()>0&&t.jsx("div",{className:"absolute top-4 left-4 z-20",children:t.jsxs("span",{className:"bg-yellow-400 text-gray-900 text-xs font-semibold px-2 py-1 rounded-full shadow-md animate-pulse",title:"Limited-time offer!",children:[s(),"% OFF"]})}),t.jsx("button",{onClick:b,className:`absolute top-4 right-4 p-2 rounded-full transition z-20 ${a?"bg-red-500 text-white":"bg-gray-200 text-red-500"}`,title:a?"Remove from wishlist":"Add to wishlist",children:t.jsx(I,{className:"text-lg"})}),l&&t.jsx("button",{onClick:()=>l(e._id),className:"absolute top-4 left-4 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-500 hover:text-white transition shadow-md z-10",title:"Delete Listing",style:{left:e.offer&&s()>0?"4.5rem":"1rem"},children:t.jsx($,{className:"text-lg"})}),t.jsxs(g,{to:m,children:[e.imageUrls&&e.imageUrls.length>0?t.jsx("img",{src:e.imageUrls[0],alt:"home",className:"w-full h-48 object-cover rounded-md",onError:r=>{r.target.src="https://via.placeholder.com/400x300?text=No+Image",r.target.className="w-full h-48 object-cover rounded-md opacity-50"}}):t.jsx("div",{className:"w-full h-48 bg-gray-200 rounded-md flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500",children:[t.jsx("div",{className:"text-4xl mb-2",children:"🏠"}),t.jsx("p",{className:"text-sm",children:"No Image"})]})}),t.jsxs("div",{className:"p-3",children:[t.jsx("p",{className:"text-gray-700 font-semibold text-lg truncate",children:e.name}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[t.jsx(L,{className:"text-red-500"}),t.jsx("p",{className:"truncate",children:k(e.propertyNumber||e.city?{propertyNumber:e.propertyNumber,landmark:e.landmark,city:e.city,district:e.district,state:e.state,pincode:e.pincode}:e.address,!!d)})]}),t.jsx("p",{className:"text-gray-600 text-sm mt-2 truncate",children:e.description}),t.jsx("div",{className:"mt-2",children:e.offer&&s()>0?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("p",{className:"text-lg font-bold text-blue-500",children:[n(e.discountPrice),e.type==="rent"&&" / month"]}),t.jsx("p",{className:"text-sm text-gray-500 line-through",children:n(e.regularPrice)})]}):t.jsxs("p",{className:"text-lg font-bold text-blue-500",children:[n(e.regularPrice),e.type==="rent"&&" / month"]})}),t.jsxs("div",{className:"flex space-x-4 text-gray-600 text-sm mt-2",children:[t.jsx("p",{children:e.bedrooms>1?`${e.bedrooms} beds`:`${e.bedrooms} bed`}),t.jsx("p",{children:e.bathrooms>1?`${e.bathrooms} bathrooms`:`${e.bathrooms} bathroom`})]})]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("button",{onClick:N,className:"w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Book Appointment"})})]})}export{C as L};
