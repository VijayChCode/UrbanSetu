import{u as P,a as S,r as i,j as e,d as k,C}from"./index-crh2KQ3K.js";import{L}from"./ListingItem-DDkG0D7Z.js";import{L as A}from"./LocationSelector-ch0Ubu6o.js";import"./index-DDjDdRay.js";import"./addressMasking-3vIUwCOC.js";function R(){const d=P(),x=S(),[s,c]=i.useState({searchTerm:"",type:"all",parking:!1,furnished:!1,offer:!1,sort:"createdAt",order:"desc",minPrice:"",maxPrice:"",city:"",state:"",bedrooms:"",bathrooms:""}),[l,m]=i.useState([]),[h,p]=i.useState(!1),[b,g]=i.useState(!1),[f,u]=i.useState({state:"",district:"",city:""});i.useEffect(()=>{const t=new URLSearchParams(d.search);c({searchTerm:t.get("searchTerm")||"",type:t.get("type")||"all",parking:t.get("parking")==="true",furnished:t.get("furnished")==="true",offer:t.get("offer")==="true",sort:t.get("sort")||"createdAt",order:t.get("order")||"desc",minPrice:t.get("minPrice")||"",maxPrice:t.get("maxPrice")||"",city:t.get("city")||"",state:t.get("state")||"",bedrooms:t.get("bedrooms")||"",bathrooms:t.get("bathrooms")||""}),u({state:t.get("state")||"",district:t.get("district")||"",city:t.get("city")||""}),(async()=>{p(!0);try{const o=await(await fetch(`/api/listing/get?${t.toString()}`)).json();m(o),g(o.length>8)}catch(n){console.error("Error fetching listings:",n)}p(!1)})()},[d.search]);const a=t=>{const{name:r,value:n,checked:o,type:N}=t.target;c(w=>({...w,[r]:N==="checkbox"?o:n}))},j=t=>{t.preventDefault();const r=new URLSearchParams(s);x(`?${r.toString()}`)},y=async()=>{const t=new URLSearchParams(d.search);t.set("startIndex",l.length);const n=await(await fetch(`/api/listing/get?${t.toString()}`)).json();m(o=>[...o,...n]),g(n.length>=8)},v=t=>{u(t),c(r=>({...r,state:t.state,district:t.district,city:t.city}))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:[e.jsx("h3",{className:"text-3xl font-extrabold text-blue-700 mb-6 text-center drop-shadow",children:"Explore Properties (Admin View)"}),e.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Search and filter all properties across the platform"}),e.jsxs("form",{onSubmit:j,className:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-lg mb-6",children:[e.jsx("input",{type:"text",name:"searchTerm",placeholder:"Search by property name, address, or description...",value:s.searchTerm,onChange:a,className:"p-2 border rounded-md w-full"}),e.jsxs("select",{name:"sort_order",onChange:t=>{const[r,n]=t.target.value.split("_");c(o=>({...o,sort:r,order:n}))},value:`${s.sort}_${s.order}`,className:"p-2 border rounded-md w-full",children:[e.jsx("option",{value:"regularPrice_desc",children:"Price high to low"}),e.jsx("option",{value:"regularPrice_asc",children:"Price low to high"}),e.jsx("option",{value:"createdAt_desc",children:"Latest"}),e.jsx("option",{value:"createdAt_asc",children:"Oldest"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(A,{value:f,onChange:v,mode:"search"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"type",value:"all",checked:s.type==="all",onChange:a})," ","All"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"type",value:"rent",checked:s.type==="rent",onChange:a})," ","Rent"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"type",value:"sale",checked:s.type==="sale",onChange:a})," ","Sale"]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"parking",onChange:a,checked:s.parking})," ","Parking"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"furnished",onChange:a,checked:s.furnished})," ","Furnished"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"offer",onChange:a,checked:s.offer})," ","Offer"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",name:"minPrice",placeholder:"Min Price",value:s.minPrice,onChange:a,className:"p-2 border rounded-md w-full",min:0}),e.jsx("input",{type:"number",name:"maxPrice",placeholder:"Max Price",value:s.maxPrice,onChange:a,className:"p-2 border rounded-md w-full",min:0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",name:"bedrooms",placeholder:"Bedrooms",value:s.bedrooms,onChange:a,className:"p-2 border rounded-md w-full",min:1}),e.jsx("input",{type:"number",name:"bathrooms",placeholder:"Bathrooms",value:s.bathrooms,onChange:a,className:"p-2 border rounded-md w-full",min:1})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white p-2 rounded-md w-full hover:bg-blue-700 transition-colors",children:"Search"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:["All Properties (",l.length,")"]}),h&&e.jsx("p",{className:"text-center text-lg font-semibold text-blue-600 animate-pulse",children:"Loading..."}),!h&&l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("img",{src:k,alt:"No properties found",className:"w-32 h-32 object-contain mx-auto mb-4 animate-float"}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Properties Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Try adjusting your search criteria or filters"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:l.map(t=>e.jsx(L,{listing:t},t._id))}),b&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("button",{type:"button",onClick:y,className:"mt-4 bg-gray-600 text-white p-2 rounded-md w-500 hover:bg-gray-700 transition-colors",children:"Show More"})})]})]})}),e.jsx(C,{})]})}export{R as default};
