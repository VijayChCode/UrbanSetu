import{r as n,j as e,L as d,J as u,g,k as b,l as j,C as y}from"./index-crh2KQ3K.js";import{m as N}from"./addressMasking-3vIUwCOC.js";function F(){const[i,c]=n.useState([]),[h,o]=n.useState(!0),[m,x]=n.useState(null);n.useEffect(()=>{(async()=>{try{o(!0),x(null);const r=await fetch("/api/listing/get",{credentials:"include"});if(r.ok){const s=await r.json();c(s)}else throw new Error("Failed to fetch listings")}catch{x("Failed to load listings. Please try again.")}finally{o(!1)}})()},[]);const p=async t=>{if(window.confirm("Are you sure you want to delete this listing?"))try{const r=await fetch(`/api/listing/delete/${t}`,{method:"DELETE",credentials:"include"});if(r.ok)c(s=>s.filter(f=>f._id!==t)),alert("Listing deleted successfully!");else{const s=await r.json();alert(s.message||"Failed to delete listing.")}}catch{alert("An error occurred. Please try again.")}},a=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),l=t=>t.offer&&t.regularPrice&&t.discountPrice?Math.round((t.regularPrice-t.discountPrice)/t.regularPrice*100):0;return h?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsx("p",{className:"text-center mt-8 text-lg font-semibold text-blue-600 animate-pulse",children:"Loading all listings..."})})}):m?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-6xl mx-auto bg-white rounded-xl shadow-lg p-6",children:e.jsx("div",{className:"text-center text-red-600 text-lg",children:m})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsx("h3",{className:"text-3xl font-extrabold text-blue-700 drop-shadow",children:"All Listings (Admin)"}),e.jsxs(d,{to:"/admin/create-listing",className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2 mt-4 md:mt-0",children:[e.jsx(u,{})," Create New Listing"]})]}),i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"🏠"}),e.jsx("h4",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No listings yet"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Start by creating your first property listing"}),e.jsxs(d,{to:"/admin/create-listing",className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold inline-flex items-center gap-2",children:[e.jsx(u,{})," Create Your First Listing"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(t=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"relative h-48 bg-gray-200 rounded-t-lg overflow-hidden",children:[t.imageUrls&&t.imageUrls.length>0?e.jsx("img",{src:t.imageUrls[0],alt:t.name,className:"w-full h-full object-cover",onError:r=>{r.target.src="https://via.placeholder.com/400x300?text=No+Image"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx("span",{children:"No Image"})}),t.offer&&l(t)>0&&e.jsx("div",{className:"absolute top-2 left-2 z-20",children:e.jsxs("span",{className:"bg-yellow-400 text-gray-900 text-xs font-semibold px-2 py-1 rounded-full shadow-md animate-pulse",title:"Limited-time offer!",children:[l(t),"% OFF"]})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${t.type==="sale"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.type==="sale"?"For Sale":"For Rent"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-2 truncate",children:t.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-2 truncate",children:N(t.propertyNumber||t.city?{propertyNumber:t.propertyNumber,landmark:t.landmark,city:t.city,district:t.district,state:t.state,pincode:t.pincode}:t.address,!0)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-3",children:[e.jsxs("span",{children:[t.bedrooms," bed"]}),e.jsxs("span",{children:[t.bathrooms," bath"]}),t.parking&&e.jsx("span",{children:"Parking"}),t.furnished&&e.jsx("span",{children:"Furnished"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:t.offer&&l(t)>0?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a(t.discountPrice)}),e.jsx("span",{className:"text-sm text-gray-500 line-through",children:a(t.regularPrice)})]}):e.jsxs("span",{children:[a(t.regularPrice),t.type==="rent"&&e.jsx("span",{className:"text-sm text-gray-500",children:"/month"})]})}),t.offer&&l(t)>0&&e.jsxs("span",{className:"text-sm text-green-600 font-medium",children:["Save ",a(t.regularPrice-t.discountPrice)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{to:`/admin/listing/${t._id}`,className:"flex-1 bg-blue-500 text-white px-3 py-2 rounded text-sm font-medium hover:bg-blue-600 transition flex items-center justify-center gap-1",children:[e.jsx(g,{})," View"]}),e.jsxs(d,{to:`/admin/update-listing/${t._id}`,className:"flex-1 bg-yellow-500 text-white px-3 py-2 rounded text-sm font-medium hover:bg-yellow-600 transition flex items-center justify-center gap-1",children:[e.jsx(b,{})," Edit"]}),e.jsxs("button",{onClick:()=>p(t._id),className:"flex-1 bg-red-500 text-white px-3 py-2 rounded text-sm font-medium hover:bg-red-600 transition flex items-center justify-center gap-1",children:[e.jsx(j,{})," Delete"]})]})]})]},t._id))})]})})}),e.jsx(y,{})]})}export{F as default};
