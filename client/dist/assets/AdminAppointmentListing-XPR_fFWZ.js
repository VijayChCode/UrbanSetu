import{b as v,u as N,a as w,r as i,j as e}from"./index-crh2KQ3K.js";function S(){const{currentUser:l}=v(o=>o.user),m=N(),u=w(),s=new URLSearchParams(m.search),d=s.get("listingId"),g=s.get("propertyName"),b=s.get("propertyDescription"),a=s.get("listingType"),[r,f]=i.useState({date:"",time:"",message:"",purpose:"",propertyName:g||"",propertyDescription:b||""}),[x,h]=i.useState(!1),[p,c]=i.useState(!1),t=o=>{f(n=>({...n,[o.target.name]:o.target.value}))},y=async o=>{if(o.preventDefault(),!l){alert("Please sign in as admin to book an appointment."),u("/admin/profile");return}if(!r.date||!r.time||!r.message||!r.purpose||!r.propertyName||!r.propertyDescription){alert("Please fill out all fields before booking the appointment.");return}if(!d){alert("Listing information is missing. Please try again.");return}c(!0);try{const n=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...r,listingId:d})}),j=await n.json();n.ok?(h(!0),setTimeout(()=>{u("/admin/appointments")},2e3)):alert(j.message||"Failed to book appointment.")}catch(n){console.error("Error booking appointment:",n),alert("An error occurred. Please try again.")}finally{c(!1)}};return l?e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:[e.jsx("h3",{className:"text-3xl font-extrabold text-blue-700 mb-6 text-center drop-shadow",children:"Book Appointment (Admin)"}),x?e.jsxs("div",{className:"text-center text-green-600 text-xl font-semibold py-10",children:["Appointment booked successfully!",e.jsx("br",{}),"The property owner will review your request.",e.jsx("br",{}),"Redirecting to admin appointments..."]}):e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"date",name:"date",value:r.date,onChange:t,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().split("T")[0],required:!0}),e.jsx("input",{type:"time",name:"time",value:r.time,onChange:t,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("select",{name:"purpose",value:r.purpose,onChange:t,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Purpose"}),a==="rent"&&e.jsx("option",{value:"rent",children:"Rent"}),(a==="sale"||a==="buy")&&e.jsx("option",{value:"buy",children:"Buy"})]})}),e.jsx("input",{type:"text",name:"propertyName",value:r.propertyName,onChange:t,placeholder:"Property Name",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),e.jsx("textarea",{name:"propertyDescription",value:r.propertyDescription,onChange:t,placeholder:"Property Description",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:"2",required:!0}),e.jsx("textarea",{name:"message",value:r.message,onChange:t,placeholder:"Tell us about your requirements...",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:"4",required:!0}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{type:"submit",disabled:p,className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-8 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Booking...":"Book Appointment"})})]})]})}):e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:e.jsx("div",{className:"text-center text-red-600 text-xl font-semibold py-10",children:"Please sign in as admin to book an appointment."})})})}export{S as default};
