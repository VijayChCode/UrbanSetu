import{g as Lt,r as a,u as zt,v as p,j as e,P as Ye,a4 as Ge,a5 as Pt,G as ut,U as Ht,a7 as Ut,a6 as xt,f as qt,a8 as Jt,a9 as Vt,y as h,h as Kt,L as Yt,z as D,H as Ve,aa as Me,ab as Gt,a1 as Wt,E as Ce,ac as Qt,C as Xt,ad as ct}from"./index-H9gUcXfJ.js";const T="https://urbansetu.onrender.com";function ss(){const{currentUser:s}=Lt(n=>n.user),[g,I]=a.useState([]),[We,K]=a.useState(!0),[Se,Z]=a.useState(null),[$,Qe]=a.useState(""),[Y,Ae]=a.useState("all"),[pe,ee]=a.useState("all"),[de,te]=a.useState(""),[q,N]=a.useState(!1),[b,ye]=a.useState(null),[J,k]=a.useState(""),[O,L]=a.useState(""),[G,ce]=a.useState(!1),[_,se]=a.useState(null),[j,me]=a.useState([]),[S,z]=a.useState(!1),P=zt(),[Oe,F]=a.useState(null);a.useEffect(()=>{const n=async()=>{if(!s){Z("Please sign in to view your appointments"),K(!1);return}try{K(!0),Z(null);const d=await fetch(`${T}/api/bookings/my`,{credentials:"include"});if(d.ok){const u=await d.json();I(u)}else throw new Error("Failed to fetch appointments")}catch{Z("Failed to load appointments. Please try again.")}finally{K(!1)}},o=async()=>{try{const d=await fetch(`${T}/api/bookings/archived`,{credentials:"include"});if(!d.ok)throw new Error("Not allowed");const u=await d.json();me(Array.isArray(u)?u:[])}catch{me([]),s&&(s.role==="admin"||s.role==="rootadmin")&&h.error("Failed to fetch archived appointments")}};n(),o()},[s]),a.useEffect(()=>{const n=o=>{I(d=>d.filter(u=>u._id!==o.detail))};return window.addEventListener("removeAppointmentRow",n),()=>{window.removeEventListener("removeAppointmentRow",n)}},[s]),a.useEffect(()=>{s&&I(n=>n.map(o=>{const d={...o};return o.buyerId&&(o.buyerId._id===s._id||o.buyerId===s._id)&&(d.buyerId={...d.buyerId,username:s.username,email:s.email,mobileNumber:s.mobileNumber,avatar:s.avatar}),o.sellerId&&(o.sellerId._id===s._id||o.sellerId===s._id)&&(d.sellerId={...d.sellerId,username:s.username,email:s.email,mobileNumber:s.mobileNumber,avatar:s.avatar}),d}))},[s]),a.useEffect(()=>{function n(o){I(d=>d.map(u=>u._id===o.appointmentId?{...u,...o.updatedAppointment}:u))}return p.on("appointmentUpdate",n),()=>{p.off("appointmentUpdate",n)}},[]),a.useEffect(()=>{function n(d){const u=d.appointment;u.buyerId&&s&&(u.buyerId._id===s._id||u.buyerId===s._id)?u.role="buyer":u.sellerId&&s&&(u.sellerId._id===s._id||u.sellerId===s._id)&&(u.role="seller"),I(v=>[u,...v])}p.on("appointmentCreated",n);const o=d=>{I(u=>u.map(v=>{const y={...v};return v.buyerId&&(v.buyerId._id===d.userId||v.buyerId===d.userId)&&(y.buyerId={...y.buyerId,username:d.username,email:d.email,mobileNumber:d.mobileNumber,avatar:d.avatar}),v.sellerId&&(v.sellerId._id===d.userId||v.sellerId===d.userId)&&(y.sellerId={...y.sellerId,username:d.username,email:d.email,mobileNumber:d.mobileNumber,avatar:d.avatar}),y}))};return p.on("profileUpdated",o),()=>{p.off("appointmentCreated",n),p.off("profileUpdated",o)}},[s]),a.useEffect(()=>{if(!s)return;const n=setInterval(()=>{p.emit("userAppointmentsActive",{userId:s._id})},1e3);return()=>clearInterval(n)},[s]);const ne=async(n,o)=>{te(n+o);try{const d=await fetch(`${T}/api/bookings/${n}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({status:o})}),u=await d.json();if(d.status===401){h.error("Session expired or unauthorized. Please sign in again."),P("/sign-in");return}if(d.ok){I(y=>y.map(R=>R._id===n?{...R,status:o}:R));const v=o==="accepted"?"accepted":"rejected";h.success(`Appointment ${v} successfully! ${o==="accepted"?"Contact information is now visible to both parties.":""}`,{autoClose:5e3,closeOnClick:!0,pauseOnHover:!1,draggable:!1}),P("/user/my-appointments")}else h.error(u.message||"Failed to update appointment status.")}catch{h.error("An error occurred. Please try again.")}te("")},ae=async n=>{setAppointmentToHandle(n),setDeleteReason(""),setShowDeleteAppointmentModal(!0)},ke=async n=>{setAppointmentToHandle(n),setShowArchiveModal(!0)},_e=async n=>{setAppointmentToHandle(n),setShowUnarchiveModal(!0)},je=g.filter(n=>{var R,B,C,E,ie,V,Re,ue,Be,Ee;if(s._id===((B=(R=n.buyerId)==null?void 0:R._id)==null?void 0:B.toString())&&n.visibleToBuyer===!1||s._id===((E=(C=n.sellerId)==null?void 0:C._id)==null?void 0:E.toString())&&n.visibleToSeller===!1)return!1;const o=new Date(n.date)<new Date||new Date(n.date).toDateString()===new Date().toDateString()&&n.time&&n.time<new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(Y==="outdated")return o;const d=Y==="all"?!0:n.status===Y,u=pe==="all"?!0:n.role===pe,v=((ie=n.propertyName)==null?void 0:ie.toLowerCase().includes($.toLowerCase()))||((V=n.message)==null?void 0:V.toLowerCase().includes($.toLowerCase()))||((ue=(Re=n.buyerId)==null?void 0:Re.username)==null?void 0:ue.toLowerCase().includes($.toLowerCase()))||((Ee=(Be=n.sellerId)==null?void 0:Be.username)==null?void 0:Ee.toLowerCase().includes($.toLowerCase()));let y=!0;return J&&(y=y&&new Date(n.date)>=new Date(J)),O&&(y=y&&new Date(n.date)<=new Date(O)),d&&u&&v&&y}),Ie=Array.isArray(j)?j.filter(n=>{var v,y,R,B,C,E;const o=new Date(n.date)<new Date||new Date(n.date).toDateString()===new Date().toDateString()&&n.time&&n.time<new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(Y==="outdated")return o;Y==="all"||n.status;const d=((v=n.propertyName)==null?void 0:v.toLowerCase().includes($.toLowerCase()))||((y=n.message)==null?void 0:y.toLowerCase().includes($.toLowerCase()))||((B=(R=n.buyerId)==null?void 0:R.username)==null?void 0:B.toLowerCase().includes($.toLowerCase()))||((E=(C=n.sellerId)==null?void 0:C.username)==null?void 0:E.toLowerCase().includes($.toLowerCase()));let u=!0;return J&&(u=u&&new Date(n.date)>=new Date(J)),O&&(u=u&&new Date(n.date)<=new Date(O)),d&&u}):[];function De(n){se({...n,date:n.date?new Date(n.date).toISOString().split("T")[0]:"",time:n.time||"",message:n.message||"",buyerReinitiationCount:n.buyerReinitiationCount||0,sellerReinitiationCount:n.sellerReinitiationCount||0}),ce(!0)}async function Fe(n){var v,y;if(n.preventDefault(),!_)return;const o=s&&(((v=_.buyerId)==null?void 0:v._id)===s._id||_.buyerId===s._id);if(s&&(((y=_.sellerId)==null?void 0:y._id)===s._id||(_.sellerId,s._id)),(o?_.buyerReinitiationCount||0:_.sellerReinitiationCount||0)>=2){h.error("You have reached the maximum number of reinitiations for your role.");return}if(!_.buyerId||!_.sellerId){h.error("Cannot reinitiate: one of the parties no longer exists.");return}const u={..._,status:"pending"};try{const R=await fetch(`${T}/api/bookings/reinitiate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)}),B=await R.json();R.ok?(h.success("Appointment reinitiated successfully!",{autoClose:5e3,closeOnClick:!0,pauseOnHover:!1,draggable:!1}),ce(!1),se(null),P("/user/my-appointments"),I(C=>C.map(E=>E._id===B.appointment._id?{...E,...B.appointment}:E))):h.error(B.message||"Failed to reinitiate appointment.")}catch{h.error("An error occurred. Please try again.")}}const Te=(n,o)=>{I(d=>d.map(u=>u._id===n?{...u,status:o}:u))},le=async()=>{K(!0),Z(null);try{const n=await fetch(`${T}/api/bookings/my`,{credentials:"include"});if(n.ok){const d=await n.json();I(d)}else throw new Error("Failed to fetch appointments");const o=await fetch(`${T}/api/bookings/archived`,{credentials:"include"});if(o.ok){const d=await o.json();me(Array.isArray(d)?d:[])}}catch{Z("Failed to refresh appointments. Please try again.")}finally{K(!1)}},ve=n=>{if(console.log("Copy button clicked, message:",n),!n){h.error("No message to copy");return}navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(n).then(()=>{h.success("Copied",{autoClose:2e3,position:"bottom-left"})}).catch(()=>{re(n)}):re(n)},re=n=>{try{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();const d=document.execCommand("copy");document.body.removeChild(o),d?(console.log("Copy successful via fallback method"),h.success("Copied",{autoClose:2e3,position:"bottom-left"})):(console.error("Fallback copy failed"),h.error("Failed to copy message"))}catch(o){console.error("Fallback copy error:",o),h.error("Copy not supported")}};return We?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading your appointments..."})]})}):Se?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-100 py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6",children:e.jsx("div",{className:"text-center text-red-600 text-lg",children:Se})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-100 py-10 px-2 md:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-extrabold text-blue-700 drop-shadow",children:S?"Archived Appointments":"My Appointments"}),!S&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"💡 Outdated appointments (past their scheduled date) are automatically ignored when booking new appointments."})]}),e.jsx("button",{onClick:le,className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all font-semibold shadow-md ml-4",title:"Refresh appointments",children:"Refresh"}),s&&(s.role==="admin"||s.role==="rootadmin")&&e.jsx("button",{onClick:()=>z(!S),className:`bg-gradient-to-r text-white px-6 py-3 rounded-lg transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2 ${S?"from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600":"from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700"}`,children:S?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{})," Active Appointments"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{})," Archived Appointments (",j.length,")"]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Status:"}),e.jsxs("select",{className:"border rounded px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200",value:Y,onChange:n=>Ae(n.target.value),children:[e.jsx("option",{value:"all",children:"All Appointments"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"cancelledByBuyer",children:"Cancelled by Buyer"}),e.jsx("option",{value:"cancelledBySeller",children:"Cancelled by Seller"}),e.jsx("option",{value:"cancelledByAdmin",children:"Cancelled by Admin"}),e.jsx("option",{value:"deletedByAdmin",children:"Deleted by Admin"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"noShow",children:"No Show"}),e.jsx("option",{value:"outdated",children:"Outdated"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"From:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200",value:J,onChange:n=>k(n.target.value),max:O||void 0}),e.jsx("label",{className:"font-semibold",children:"To:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200",value:O,onChange:n=>L(n.target.value),min:J||void 0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Role:"}),e.jsxs("select",{className:"border rounded px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200",value:pe,onChange:n=>ee(n.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"buyer",children:"As Buyer"}),e.jsx("option",{value:"seller",children:"As Seller"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"text-gray-500"}),e.jsx("input",{type:"text",className:"border rounded px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Search by property, message, or user...",value:$,onChange:n=>Qe(n.target.value)})]})]}),S&&s&&(s.role==="admin"||s.role==="rootadmin")?Ie.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg",children:"No archived appointments found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse rounded-lg overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-200",children:[e.jsx("th",{className:"border p-2",children:"Date & Time"}),e.jsx("th",{className:"border p-2",children:"Property"}),e.jsx("th",{className:"border p-2",children:"Role"}),e.jsx("th",{className:"border p-2",children:"Other Party"}),e.jsx("th",{className:"border p-2",children:"Purpose"}),e.jsx("th",{className:"border p-2",children:"Message"}),e.jsx("th",{className:"border p-2",children:"Status"}),e.jsx("th",{className:"border p-2",children:"Actions"}),e.jsx("th",{className:"border p-2",children:"Connect"})]})}),e.jsx("tbody",{children:Ie.map(n=>e.jsx(mt,{appt:n,currentUser:s,handleStatusUpdate:ne,handleAdminDelete:ae,actionLoading:de,onShowOtherParty:o=>{ye(o),N(!0)},onOpenReinitiate:()=>De(n),handleArchiveAppointment:ke,handleUnarchiveAppointment:_e,isArchived:!0,onCancelRefresh:Te,copyMessageToClipboard:ve},n._id))})]})}):je.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg",children:"No appointments found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse rounded-lg overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-blue-100 to-purple-100",children:[e.jsx("th",{className:"border p-2",children:"Date & Time"}),e.jsx("th",{className:"border p-2",children:"Property"}),e.jsx("th",{className:"border p-2",children:"Role"}),e.jsx("th",{className:"border p-2",children:"Other Party"}),e.jsx("th",{className:"border p-2",children:"Purpose"}),e.jsx("th",{className:"border p-2",children:"Message"}),e.jsx("th",{className:"border p-2",children:"Status"}),e.jsx("th",{className:"border p-2",children:"Actions"}),e.jsx("th",{className:"border p-2",children:"Connect"})]})}),e.jsx("tbody",{children:je.map(n=>e.jsx(mt,{appt:n,currentUser:s,handleStatusUpdate:ne,handleAdminDelete:ae,actionLoading:de,onShowOtherParty:o=>{ye(o),N(!0)},onOpenReinitiate:()=>De(n),handleArchiveAppointment:ke,handleUnarchiveAppointment:_e,isArchived:!1,onCancelRefresh:Te,copyMessageToClipboard:ve},n._id))})]})}),q&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-2 sm:mx-4 max-h-[90vh] overflow-y-auto relative animate-fadeIn",children:[e.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-full p-2 transition-colors z-10 shadow",onClick:()=>N(!1),title:"Close","aria-label":"Close",children:e.jsx(ut,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex flex-col items-center justify-center bg-gradient-to-r from-blue-100 to-purple-100 rounded-t-2xl px-6 py-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ht,{user:{username:b.username,avatar:b.avatar},size:"w-16 h-16",textSize:"text-lg",showBorder:!0,className:"border-4 border-white shadow-lg"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 border-2 border-white rounded-full flex items-center justify-center",children:e.jsx(Ut,{className:"w-3 h-3 text-white"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-blue-800 flex items-center gap-2",children:[b.username||"User",b.role==="admin"&&e.jsx(xt,{className:"text-purple-600 text-base",title:"Admin user"})]}),e.jsx("p",{className:"text-sm text-gray-600 capitalize font-medium bg-white px-3 py-1 rounded-full shadow-sm",children:b.role||"User"})]})]})}),e.jsxs("div",{className:"px-6 py-6 space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border-l-4 border-blue-500",children:[e.jsx(qt,{className:"text-blue-500 w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"Email"}),e.jsx("p",{className:"text-gray-800 font-medium",children:b.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border-l-4 border-green-500",children:[e.jsx(Jt,{className:"text-green-500 w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"Phone"}),e.jsx("p",{className:"text-gray-800 font-medium",children:b.mobileNumber||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border-l-4 border-purple-500",children:[e.jsx(Vt,{className:"text-purple-500 w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"Member Since"}),e.jsx("p",{className:"text-gray-800 font-medium",children:b.createdAt?new Date(b.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available"})]})]})]}),e.jsx("button",{onClick:()=>N(!1),className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold",children:"Close"})]})]})}),G&&_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"Reinitiate Appointment"}),e.jsxs("form",{onSubmit:Fe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:_.date,onChange:n=>se(o=>({...o,date:n.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Time"}),e.jsx("input",{type:"time",className:"border rounded px-2 py-1 w-full",value:_.time,onChange:n=>se(o=>({...o,time:n.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Message"}),e.jsx("textarea",{className:"border rounded px-2 py-1 w-full",value:_.message,onChange:n=>se(o=>({...o,message:n.target.value})),required:!0})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full",children:"Submit"}),e.jsx("button",{type:"button",className:"mt-2 w-full bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",onClick:()=>ce(!1),children:"Cancel"})]})]})})]})})}function Ke(s){const g=new Date,I=new Date;return I.setDate(g.getDate()-1),s.toDateString()===g.toDateString()?"Today":s.toDateString()===I.toDateString()?"Yesterday":s.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}function mt({appt:s,currentUser:g,handleStatusUpdate:I,handleAdminDelete:We,actionLoading:K,onShowOtherParty:Se,onOpenReinitiate:Z,handleArchiveAppointment:$,handleUnarchiveAppointment:Qe,isArchived:Y,onCancelRefresh:Ae,copyMessageToClipboard:pe}){var rt,it;const[ee,de]=a.useState(null),[te,q]=a.useState(""),[N,b]=a.useState(s.comments||[]),[ye,J]=a.useState(!1),[k,O]=a.useState(null),[L,G]=a.useState(""),[ce,_]=a.useState(null),se=Kt(),[j,me]=a.useState(!1),S=a.useRef(null),z=a.useRef(null),[P,Oe]=a.useState(!0),[F,ne]=a.useState(0),[ae,ke]=a.useState(""),[_e,je]=a.useState(!1),[Ie,De]=a.useState(!1),[Fe,Te]=a.useState(!1),[le,ve]=a.useState(!1),[re,n]=a.useState(!1),[o,d]=a.useState(!1),u=a.useRef(null),v=a.useRef(null),y=a.useRef(null),[R,B]=a.useState(!1),[C,E]=a.useState(null),[ie,V]=a.useState(!0),[Re,ue]=a.useState(!1),[Be,Ee]=a.useState(!1),[ht,gt]=a.useState(!1),[ft,bt]=a.useState(!1),[pt,$e]=a.useState(!1),[yt,Le]=a.useState(!1),[jt,ze]=a.useState(!1),[Zt,Pe]=a.useState(null),[xe,W]=a.useState(""),[vt,Xe]=a.useState(""),oe=a.useRef({});a.useEffect(()=>{if(re){const t=setTimeout(()=>{n(!1)},1e4);return()=>clearTimeout(t)}},[re]);function He(t){try{return JSON.parse(localStorage.getItem(`removedDeletedMsgs_${t}`))||[]}catch{return[]}}function wt(t,l){const r=He(t);if(!r.includes(l)){const m=[...r,l];localStorage.setItem(`removedDeletedMsgs_${t}`,JSON.stringify(m))}}const Ue=(g.role==="admin"||g.role==="rootadmin")&&g.adminApprovalStatus==="approved",Nt=se.pathname.includes("/admin"),M=s.role==="seller",he=s.role==="buyer",Q=new Date(s.date)>new Date||new Date(s.date).toDateString()===new Date().toDateString()&&(!s.time||s.time>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),H=!Q||s.status==="pending"||s.status==="rejected"||s.status==="cancelledByAdmin",Ze=(Ue||s.status==="accepted")&&Q,c=M?s.buyerId:s.sellerId,Ct=t=>{E(t),V(!0),B(!0)},St=t=>{E(t),V(!1),B(!0)},At=async()=>{if(C){try{if(ie){const t=await fetch(`${T}/api/bookings/${s._id}/comment/${C._id}`,{method:"DELETE",credentials:"include"}),l=await t.json();t.ok?(b(r=>l.comments.map(m=>{const i=r.find(x=>x._id===m._id);return i&&i.status==="read"&&m.status!=="read"?{...m,status:"read"}:m})),h.success("Message deleted for everyone!")):h.error(l.message||"Failed to delete message.")}else b(t=>t.filter(l=>l._id!==C._id)),wt(s._id,C._id),h.success("Message deleted for you!")}catch{h.error("An error occurred. Please try again.")}B(!1),E(null),V(!0)}},kt=()=>{localStorage.setItem(lt,Date.now()),b([]),h.success("Chat Cleared"),ue(!1)},et=async()=>{if(!te.trim())return;const t=te.trim(),l=ee,r=`temp-${Date.now()}`,m={_id:r,sender:g._id,senderEmail:g.email,senderName:g.username,message:t,status:"sending",timestamp:new Date().toISOString(),readBy:[g._id],...l?{replyTo:l._id}:{}};b(i=>[...i,m]),q(""),de(null),J(!0),setTimeout(()=>{S.current&&S.current.scrollIntoView({behavior:"smooth"})},50);try{const i=await fetch(`${T}/api/bookings/${s._id}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:t,...l?{replyTo:l._id}:{}})}),x=await i.json();if(i.ok){const f=x.comments[x.comments.length-1];b(w=>w.map(A=>A._id===r?{...f}:A))}else b(f=>f.filter(w=>w._id!==r)),h.error(x.message||"Failed to send message.")}catch{b(x=>x.filter(f=>f._id!==r)),h.error("An error occurred. Please try again.")}finally{J(!1)}},tt=async t=>{if(!L.trim())return;_(t),b(r=>r.map(m=>m._id===t?{...m,message:L,edited:!0,editedAt:new Date}:m)),O(null),G(""),q("");try{const r=await fetch(`${T}/api/bookings/${s._id}/comment/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:L})}),m=await r.json();r.ok?(b(i=>i.map(x=>{const f=m.comments.find(w=>w._id===x._id);return f?f._id===t?f:x.status==="read"&&f.status!=="read"?{...f,status:"read"}:f:x})),h.success("Message edited successfully!")):(b(i=>i.map(x=>x._id===t?{...x,message:x.originalMessage||x.message,edited:x.wasEdited||!1}:x)),O(t),G(L),q(L),h.error(m.message||"Failed to edit message."))}catch{b(m=>m.map(i=>i._id===t?{...i,message:i.originalMessage||i.message,edited:i.wasEdited||!1}:i)),O(t),G(L),q(L),h.error("An error occurred. Please try again.")}finally{_(null)}},_t=t=>{O(t._id),G(t.message),q(t.message),b(l=>l.map(r=>r._id===t._id?{...r,originalMessage:r.message,wasEdited:r.edited}:r)),setTimeout(()=>{y.current&&(y.current.focus(),y.current.select())},100)},It=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";case"cancelledByBuyer":return"bg-orange-100 text-orange-700";case"cancelledBySeller":return"bg-pink-100 text-pink-700";case"cancelledByAdmin":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}},st=async()=>{W(""),$e(!0)},Dt=async()=>{if(M&&!xe.trim()){h.error("Reason is required for seller cancellation.");return}try{const t=await fetch(`${T}/api/bookings/${s._id}/cancel`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reason:xe})}),l=await t.json();if(t.status===401){h.error("Session expired or unauthorized. Please sign in again."),navigate("/sign-in");return}t.ok?(h.success("Appointment cancelled successfully."),typeof Ae=="function"&&Ae(s._id,M?"cancelledBySeller":"cancelledByBuyer")):h.error(l.message||"Failed to cancel appointment."),$e(!1),W("")}catch{h.error("An error occurred. Please try again.")}},Tt=async()=>{W(""),Le(!0)},Rt=async()=>{if(!xe.trim()){h.error("Reason is required for admin cancellation.");return}try{const t=await fetch(`${T}/api/bookings/${s._id}/cancel`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reason:xe})}),l=await t.json();if(t.status===401){h.error("Session expired or unauthorized. Please sign in again."),navigate("/sign-in");return}t.ok?(h.success("Appointment cancelled by admin."),navigate("/user/my-appointments")):h.error(l.message||"Failed to cancel appointment."),Le(!1),W("")}catch{h.error("An error occurred. Please try again.")}},qe=async()=>{ze(!0)},Bt=async()=>{try{const t=he?"buyer":M?"seller":null;if(!t)return;if((await fetch(`${T}/api/bookings/${s._id}/soft-delete`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({who:t})})).ok){if(typeof window<"u"){const r=new CustomEvent("removeAppointmentRow",{detail:s._id});window.dispatchEvent(r),h.success("Appointment removed from your table successfully")}}else h.error("Failed to remove appointment from table.");ze(!1)}catch{h.error("An error occurred. Please try again.")}};a.useEffect(()=>{j&&S.current&&S.current.scrollIntoView({behavior:"smooth"})},[j]);const ge=a.useCallback(async()=>{if(!z.current)return;const{scrollTop:t,scrollHeight:l,clientHeight:r}=z.current;if(!(l-t-r<10))return;const i=N.filter(x=>{var f;return!((f=x.readBy)!=null&&f.includes(g._id))&&x.senderEmail!==g.email});if(i.length>0)try{(await fetch(`${T}/api/bookings/${s._id}/comments/read`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"})).ok&&(b(f=>f.map(w=>i.some(A=>A._id===w._id)?{...w,readBy:[...w.readBy||[],g._id],status:"read"}:w)),i.forEach(f=>{p.emit("messageRead",{appointmentId:s._id,messageId:f._id,userId:g._id,readBy:g._id})}),console.log(`Marked ${i.length} messages as read for user ${g._id}`))}catch(x){console.error("Error marking messages as read:",x)}},[N,g._id,s._id,p]),nt=a.useRef(N.length),Et=a.useRef(N);a.useEffect(()=>{const t=N.slice(nt.current),l=t.length;if(nt.current=N.length,Et.current=N,l>0&&j){const r=t.some(i=>i.senderEmail===g.email),m=t.filter(i=>i.senderEmail!==g.email);r||P?setTimeout(()=>{S.current&&(S.current.scrollIntoView({behavior:"smooth"}),P&&m.length>0&&setTimeout(()=>{ge()},300))},100):m.length>0&&ne(i=>i+m.length)}},[N.length,P,j,g.email,ge]);const at=a.useCallback(()=>{if(z.current){const{scrollTop:t,scrollHeight:l,clientHeight:r}=z.current,m=l-t-r<10;if(Oe(m),m){const i=N.filter(x=>{var f;return!((f=x.readBy)!=null&&f.includes(g._id))&&x.senderEmail!==g.email}).length;i>0&&(console.log(`User manually scrolled to bottom, marking ${i} messages as read`),ge()),F>0&&ne(0)}}},[F,ge,N,g._id]),Je=a.useCallback(()=>{if(!z.current||N.length===0)return;const t=`chatClearTime_${s._id}`,l=Number(localStorage.getItem(t))||0,r=He(s._id),m=N.filter(A=>new Date(A.timestamp).getTime()>l&&!r.includes(A._id));if(m.length===0)return;const x=z.current.getBoundingClientRect(),f=x.top+60;let w="";for(let A=0;A<m.length;A++){const X=oe.current[m[A]._id];if(X){const fe=X.getBoundingClientRect();if(fe.top>=f&&fe.bottom<=x.bottom){const be=new Date(m[A].timestamp);w=Ke(be);break}}}if(!w)for(let A=0;A<m.length;A++){const X=oe.current[m[A]._id];if(X&&X.getBoundingClientRect().bottom>f){const be=new Date(m[A].timestamp);w=Ke(be);break}}w&&w!==ae&&ke(w)},[N,ae,s._id]);a.useEffect(()=>{const t=z.current;if(t&&j){const l=()=>{at(),Je(),je(!0),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{je(!1)},1e3)};if(t.addEventListener("scroll",l),t){const{scrollTop:r,scrollHeight:m,clientHeight:i}=t,x=m-r-i<10;Oe(x)}return setTimeout(Je,100),()=>{t.removeEventListener("scroll",l),v.current&&clearTimeout(v.current)}}},[j,at,Je]),a.useEffect(()=>{j&&S.current&&S.current.scrollIntoView({behavior:"smooth"})},[j]);const Mt=a.useCallback(()=>{S.current&&(S.current.scrollIntoView({behavior:"smooth"}),ne(0),setTimeout(()=>{ge()},500))},[ge]);a.useEffect(()=>{function t(l){var r,m;if(l.appointmentId===s._id&&!j){const i=l.comment.senderEmail===((r=s.buyerId)==null?void 0:r.email),x=l.comment.senderEmail===((m=s.sellerId)==null?void 0:m.email),w=!i&&!x?"Organization":l.comment.senderEmail||"User";h.info(`New message from ${w}`)}}return p.on("commentUpdate",t),()=>{p.off("commentUpdate",t)}},[s._id,j]),a.useEffect(()=>{function t(l){l.appointmentId===s._id&&(b(r=>{const m=r.findIndex(i=>i._id===l.comment._id);if(m!==-1){const i=[...r],x=r[m],f=l.comment;let w=f.status;return x.status==="read"&&f.status!=="read"&&(w="read"),i[m]={...f,status:w},i}else return!r.some(x=>x._id.toString().startsWith("temp-"))||l.comment.senderEmail!==g.email?[...r,l.comment]:r}),j&&l.comment.senderEmail!==g.email&&(setTimeout(()=>{fetch(`${T}/api/bookings/${s._id}/comments/read`,{method:"PATCH",credentials:"include"})},100),setTimeout(()=>{S.current&&P&&S.current.scrollIntoView({behavior:"smooth"})},50)))}return p.on("commentUpdate",t),()=>{p.off("commentUpdate",t)}},[s._id,b,j,g.email,P]),a.useEffect(()=>{j&&(fetch(`${T}/api/bookings/${s._id}/comments/read`,{method:"PATCH",credentials:"include"}),N.length===0&&(d(!0),fetch(`${T}/api/bookings/${s._id}`).then(t=>t.json()).then(t=>{t&&Array.isArray(t.comments)&&b(t.comments)}).catch(t=>console.error("Failed to fetch comments:",t)).finally(()=>d(!1))))},[j,s._id,N.length]),a.useEffect(()=>{function t(r){r.appointmentId===s._id&&b(m=>m.map(i=>i._id===r.commentId?{...i,status:i.status==="read"?"read":"delivered"}:i))}function l(r){r.appointmentId===s._id&&b(m=>m.map(i=>{var x;return(x=i.readBy)!=null&&x.includes(r.userId)?i:{...i,status:"read",readBy:[...i.readBy||[],r.userId]}}))}return p.on("commentDelivered",t),p.on("commentRead",l),()=>{p.off("commentDelivered",t),p.off("commentRead",l)}},[s._id,b]);const we=N.filter(t=>{var l;return!((l=t.readBy)!=null&&l.includes(g._id))&&t.senderEmail!==g.email}).length;a.useEffect(()=>(j?document.body.style.overflow="hidden":(document.body.style.overflow="",ne(0)),()=>{document.body.style.overflow=""}),[j]);const lt=`chatClearTime_${s._id}`,Ot=Number(localStorage.getItem(lt))||0,Ft=He(s._id),Ne=N.filter(t=>new Date(t.timestamp).getTime()>Ot&&!Ft.includes(t._id));return a.useEffect(()=>{if(!j||!(c!=null&&c._id))return;p.emit("checkUserOnline",{userId:c._id});function t(l){l.userId===c._id&&De(!!l.online)}return p.on("userOnlineStatus",t),p.on("userOnlineUpdate",t),()=>{p.off("userOnlineStatus",t),p.off("userOnlineUpdate",t)}},[j,c==null?void 0:c._id]),a.useEffect(()=>{if(!(c!=null&&c._id))return;p.emit("checkUserOnline",{userId:c._id});function t(l){l.userId===c._id&&Te(!!l.online)}return p.on("userOnlineStatus",t),p.on("userOnlineUpdate",t),()=>{p.off("userOnlineStatus",t),p.off("userOnlineUpdate",t)}},[c==null?void 0:c._id]),a.useEffect(()=>{function t(l){l.fromUserId===(c==null?void 0:c._id)&&l.appointmentId===s._id&&(ve(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>ve(!1),1e3))}return p.on("typing",t),()=>{p.off("typing",t),u.current&&clearTimeout(u.current)}},[c==null?void 0:c._id,s._id]),a.useEffect(()=>{if(!j)return;const t=l=>{var r;l.ctrlKey&&l.key==="f"&&(l.preventDefault(),(r=y.current)==null||r.focus())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[j]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:`hover:bg-blue-50 transition align-top ${Q?"":"bg-gray-100"}`,children:[e.jsx("td",{className:"border p-2",children:e.jsxs("div",{children:[e.jsx("div",{children:new Date(s.date).toLocaleDateString("en-GB")}),e.jsx("div",{className:"text-sm text-gray-600",children:s.time}),!Q&&e.jsx("div",{className:"text-xs text-red-600 font-medium mt-1",children:"Outdated"})]})}),e.jsx("td",{className:"border p-2",children:e.jsx("div",{children:s.listingId?e.jsx(Yt,{to:Nt?`/admin/listing/${s.listingId._id}`:`/user/listing/${s.listingId._id}`,className:"font-semibold text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",children:s.propertyName}):e.jsx("div",{className:"font-semibold",children:s.propertyName})})}),e.jsx("td",{className:"border p-2 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${M?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:M?"Seller":"Buyer"})}),e.jsx("td",{className:"border p-2",children:e.jsxs("div",{children:[Ze?e.jsx("button",{className:"font-semibold text-blue-700 hover:underline text-left",style:{cursor:"pointer"},onClick:()=>Se(c),title:"Click to view details",children:(c==null?void 0:c.username)||"Unknown"}):e.jsx("span",{className:"font-semibold",children:(c==null?void 0:c.username)||"Unknown"}),Ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-600",children:c==null?void 0:c.email}),e.jsx("div",{className:"text-sm text-gray-600",children:c!=null&&c.mobileNumber&&(c==null?void 0:c.mobileNumber)!==""?c.mobileNumber:"No phone"})]}):e.jsx("div",{className:"text-sm text-gray-500 italic",children:Ue?"Contact info available":"Contact info hidden until accepted"})]})}),e.jsx("td",{className:"border p-2 capitalize",children:s.purpose}),e.jsx("td",{className:"border p-2 max-w-xs truncate",children:s.message}),e.jsx("td",{className:"border p-2 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${It(s.status)}`,children:s.status==="cancelledByBuyer"?"Cancelled by Buyer":s.status==="cancelledBySeller"?"Cancelled by Seller":s.status==="cancelledByAdmin"?"Cancelled by Admin":s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"border p-2 text-center",children:e.jsx("div",{className:"flex flex-col gap-2",children:Q?e.jsxs(e.Fragment,{children:[M&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"text-green-500 hover:text-green-700 text-xl disabled:opacity-50",onClick:()=>I(s._id,"accepted"),disabled:K===s._id+"accepted",title:"Accept Appointment",children:e.jsx(Ve,{})}),e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xl disabled:opacity-50",onClick:()=>I(s._id,"rejected"),disabled:K===s._id+"rejected",title:"Reject Appointment",children:e.jsx(ut,{})})]}),M&&s.status==="accepted"&&e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xl",onClick:st,title:"Cancel Appointment (Seller)",children:e.jsx(D,{})}),M&&(s.status==="cancelledBySeller"||s.status==="cancelledByBuyer"||s.status==="cancelledByAdmin"||s.status==="rejected"||s.status==="deletedByAdmin")&&e.jsx("button",{className:"text-gray-400 hover:text-red-700 text-xl",onClick:qe,title:"Remove from table",style:{opacity:.5},children:e.jsx(D,{className:"group-hover:text-red-900 group-hover:scale-125 group-hover:animate-shake transition-all duration-200"})}),he&&(s.status==="pending"||s.status==="accepted")&&e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xl",onClick:st,title:"Cancel Appointment (Buyer)",children:e.jsx(D,{})}),he&&(s.status==="cancelledByBuyer"||s.status==="cancelledBySeller"||s.status==="cancelledByAdmin"||s.status==="deletedByAdmin"||s.status==="rejected")&&e.jsx("button",{className:"text-gray-400 hover:text-red-700 text-xl",onClick:qe,title:"Remove from table",style:{opacity:.5},children:e.jsx(D,{className:"group-hover:text-red-900 group-hover:scale-125 group-hover:animate-shake transition-all duration-200"})}),Ue&&e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xl",onClick:Tt,title:"Cancel Appointment (Admin)",children:e.jsx(xt,{})}),(s.status==="cancelledByBuyer"&&he||s.status==="cancelledBySeller"&&M)&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("button",{className:"text-blue-500 hover:text-blue-700 text-xs border border-blue-500 rounded px-2 py-1 mt-1",onClick:()=>Z(s),disabled:s.status==="cancelledByBuyer"&&he&&(s.buyerReinitiationCount||0)>=2||s.status==="cancelledBySeller"&&M&&(s.sellerReinitiationCount||0)>=2||!s.buyerId||!s.sellerId,title:"Reinitiate or Reschedule Appointment",children:"Reinitiate"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:he&&s.status==="cancelledByBuyer"?`${2-(s.buyerReinitiationCount||0)} left`:M&&s.status==="cancelledBySeller"?`${2-(s.sellerReinitiationCount||0)} left`:""})]})]}):e.jsx("button",{className:"text-gray-400 hover:text-red-700 text-xl",onClick:qe,title:"Delete outdated appointment from table",style:{opacity:.7},children:e.jsx(D,{size:18})})})}),e.jsx("td",{className:"border p-2 text-center relative",children:e.jsxs("button",{className:`flex items-center justify-center rounded-full p-2 shadow-md mx-auto relative ${H?"bg-gray-100 text-gray-400 cursor-not-allowed opacity-50":"bg-blue-100 hover:bg-blue-200 text-blue-700"}`,title:H?Q?s.status==="pending"?"Chat not available for pending appointments":s.status==="rejected"?"Chat not available for rejected appointments":"Chat not available for appointments cancelled by admin":"Chat not available for outdated appointments":"Open Chat",onClick:H?void 0:()=>me(!0),disabled:H,children:[e.jsx(Me,{size:20}),le&&!H&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center font-bold border-2 border-white animate-pulse",children:"..."}),!le&&we>0&&H&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-gray-400 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center font-bold border-2 border-white",children:we}),!le&&we>0&&!H&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center font-bold border-2 border-white",children:we}),!le&&we===0&&Fe&&!H&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 border-2 border-white rounded-full w-3 h-3"})]})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 rounded-2xl shadow-2xl w-full h-full max-w-6xl max-h-full p-0 relative animate-fadeIn flex flex-col",children:[H?e.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 p-8 min-h-96",children:[e.jsx(Me,{className:"text-6xl text-gray-400 mb-6"}),e.jsx("div",{className:"text-xl font-semibold text-gray-500 text-center",children:Q?s.status==="pending"?"Chat not available for pending appointments":s.status==="rejected"?"Chat not available for rejected appointments":"Chat not available for appointments cancelled by admin":"Chat not available for outdated appointments"}),e.jsx("div",{className:"text-gray-400 text-center mt-2",children:Q?s.status==="pending"?"Chat will be enabled once the appointment is accepted":s.status==="rejected"?"This appointment has been rejected":"This appointment has been cancelled by admin":"This appointment has already passed"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-200 to-purple-200 rounded-t-2xl relative",children:[e.jsx(Me,{className:"text-blue-600 text-xl"}),e.jsx("h3",{className:"text-lg font-bold text-blue-800",children:"Chat"}),le?e.jsx("span",{className:"ml-3 text-blue-600 font-semibold text-sm",children:"Typing..."}):Ie?e.jsx("span",{className:"ml-3 text-green-600 font-semibold text-sm",children:"Online"}):e.jsx("span",{className:"ml-3 text-gray-600 font-semibold text-sm",children:"Offline"}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[Ne.length>0&&e.jsx("button",{className:"text-xs text-red-600 hover:underline",onClick:()=>ue(!0),title:"Clear chat locally",children:"Clear Chat"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"text-yellow-500 hover:text-yellow-600 bg-yellow-50 hover:bg-yellow-100 rounded-full p-2 transition-colors shadow",onClick:()=>n(!re),title:"Keyboard shortcut tip","aria-label":"Show keyboard shortcut tip",children:e.jsx(Gt,{className:"text-sm"})}),re&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 bg-gray-800 text-white text-xs rounded-lg px-3 py-2 shadow-lg z-20 whitespace-nowrap",children:["Press Ctrl + F to quickly focus and type your message.",e.jsx("div",{className:"absolute -top-1 right-4 w-2 h-2 bg-gray-800 transform rotate-45"})]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-full p-2 transition-colors z-10 shadow",onClick:()=>me(!1),title:"Close","aria-label":"Close",children:"×"})]})]}),e.jsxs("div",{ref:z,className:"flex-1 overflow-y-auto space-y-2 mb-4 px-4 pt-4 animate-fadeInChat relative",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)"},children:[ae&&Ne.length>0&&e.jsx("div",{className:`sticky top-0 left-0 right-0 z-30 pointer-events-none transition-all duration-300 ease-in-out ${_e?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:e.jsx("div",{className:"w-full flex justify-center py-2",children:e.jsx("div",{className:"bg-blue-600 text-white text-xs px-4 py-2 rounded-full shadow-lg border-2 border-white",children:ae})})}),o?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium text-sm",children:"Loading messages..."})]}):Ne.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[e.jsx(Me,{className:"text-gray-300 text-4xl mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium text-sm",children:"No messages yet"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Start the conversation and connect with the other party"})]}):Ne.map((t,l)=>{var w,A,X,fe,be;const r=t.senderEmail===g.email,m=k===t._id,i=new Date(t.timestamp),x=l>0?new Date(Ne[l-1].timestamp):null,f=x?i.toDateString()!==x.toDateString():!0;return i.toLocaleDateString("en-US",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}),e.jsxs(Wt.Fragment,{children:[f&&e.jsx("div",{className:"w-full flex justify-center my-2",children:e.jsx("span",{className:"bg-blue-600 text-white text-xs px-4 py-2 rounded-full shadow-lg border-2 border-white",children:Ke(i)})}),e.jsx("div",{className:`flex w-full ${r?"justify-end":"justify-start"} animate-fadeInChatBubble`,style:{animationDelay:`${.03*l}s`},children:e.jsxs("div",{ref:U=>oe.current[t._id]=U,"data-message-id":t._id,className:`rounded-2xl px-4 py-2 text-sm shadow-lg max-w-[60%] break-words relative ${r?"bg-gradient-to-r from-blue-400 to-blue-600 text-white":"bg-white text-gray-800 border border-gray-200"}`,style:{animationDelay:`${.03*l}s`},children:[t.replyTo&&e.jsx("div",{className:"border-l-4 border-blue-300 pl-2 mb-1 text-xs text-gray-500 bg-blue-50 rounded w-full max-w-full break-words cursor-pointer",onClick:()=>{oe.current[t.replyTo]&&(oe.current[t.replyTo].scrollIntoView({behavior:"smooth",block:"center"}),oe.current[t.replyTo].classList.add("ring-2","ring-yellow-400"),setTimeout(()=>{oe.current[t.replyTo].classList.remove("ring-2","ring-yellow-400")},1e3))},role:"button",tabIndex:0,"aria-label":"Go to replied message",children:e.jsxs("span",{className:"text-xs text-gray-600 truncate max-w-[150px]",children:[((A=(w=N.find(U=>U._id===t.replyTo))==null?void 0:w.message)==null?void 0:A.substring(0,30))||"Original message",((fe=(X=N.find(U=>U._id===t.replyTo))==null?void 0:X.message)==null?void 0:fe.length)>30?"...":""]})}),e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2 flex-wrap break-all",children:[e.jsx("span",{className:"truncate max-w-[60%] min-w-[80px] inline-block align-middle overflow-hidden text-ellipsis",children:r?"You":(()=>{var ot,dt;const U=t.senderEmail===((ot=s.buyerId)==null?void 0:ot.email),$t=t.senderEmail===((dt=s.sellerId)==null?void 0:dt.email);return!U&&!$t?"Organization":(c==null?void 0:c.username)||t.senderName||t.senderEmail})()}),e.jsx("span",{className:"text-gray-300 ml-2 text-[10px]",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})})]}),e.jsx("div",{className:"flex items-center gap-1",children:t.deleted?e.jsxs("span",{className:"flex items-center gap-1 text-gray-400 italic",children:[e.jsx(Ce,{className:"inline-block text-lg"})," ",t.senderEmail===g.email?"You deleted this message":"This message was deleted.",e.jsx("button",{className:"ml-2 text-red-700 hover:text-red-900",onClick:()=>{E(t),V(!1),B(!0)},title:"Remove this deleted message from your chat view",children:e.jsx(D,{className:"group-hover:text-red-900 group-hover:scale-125 group-hover:animate-shake transition-all duration-200"})})]}):e.jsx("div",{children:m?e.jsx("div",{className:"bg-yellow-100 border-l-4 border-yellow-400 px-2 py-1 rounded",children:e.jsx("span",{className:"text-yellow-800 text-xs font-medium",children:"✏️ Editing this message below..."})}):e.jsxs(e.Fragment,{children:[t.message,t.edited&&e.jsx("span",{className:"ml-2 text-[10px] italic text-gray-300",children:"(Edited)"})]})})}),e.jsxs("div",{className:"flex items-center gap-2 justify-end mt-1",children:[!t.deleted&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`${r?"text-yellow-500 hover:text-yellow-700":"text-blue-600 hover:text-blue-800"}`,onClick:()=>{var U;de(t),(U=y.current)==null||U.focus()},title:"Reply",children:e.jsx("svg",{width:"18",height:"18",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 9V5l-7 7 7 7v-4.1c4.28 0 6.92 1.45 8.84 4.55.23.36.76.09.65-.32C18.31 13.13 15.36 10.36 10 9z"})})}),e.jsx("button",{className:`${r?"text-blue-400 hover:text-blue-300":"text-gray-600 hover:text-gray-800"}`,onClick:()=>{console.log("Button clicked! Message:",t.message),pe(t.message)},title:"Copy message",children:e.jsx(Qt,{size:14})})]}),t.senderEmail===g.email&&!t.deleted&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>_t(t),className:"text-green-800 hover:text-green-950",title:"Edit comment",disabled:k!==null,children:e.jsx(Xt,{size:12})}),e.jsx("button",{className:"text-red-700 hover:text-red-900",onClick:()=>Ct(t),children:e.jsx(D,{className:"group-hover:text-red-900 group-hover:scale-125 group-hover:animate-shake transition-all duration-200"})}),e.jsx("span",{className:"ml-1",children:(be=t.readBy)!=null&&be.includes(c==null?void 0:c._id)?e.jsx(ct,{className:"text-white inline",title:"Read"}):t.status==="delivered"?e.jsx(ct,{className:"text-white/70 inline",title:"Delivered"}):t.status==="sending"?e.jsx(Ve,{className:"text-white/50 inline animate-pulse",title:"Sending..."}):e.jsx(Ve,{className:"text-white/70 inline",title:"Sent"})})]}),!r&&!m&&!t.deleted&&e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xs",onClick:()=>St(t),title:"Delete message locally",children:e.jsx(D,{size:14})})]})]})})]},t._id||l)}),e.jsx("div",{ref:S})]}),ee&&e.jsx("div",{className:"px-4 mb-2",children:e.jsxs("div",{className:"flex items-center bg-blue-50 border-l-4 border-blue-400 px-2 py-1 rounded",children:[e.jsx("span",{className:"text-xs text-gray-700 font-semibold mr-2",children:"Replying to:"}),e.jsxs("span",{className:"text-xs text-gray-600 truncate max-w-[200px]",children:[(rt=ee.message)==null?void 0:rt.substring(0,40),((it=ee.message)==null?void 0:it.length)>40?"...":""]}),e.jsx("button",{className:"ml-auto text-gray-400 hover:text-gray-700",onClick:()=>de(null),title:"Cancel reply",children:"×"})]})}),k&&e.jsx("div",{className:"px-4 mb-2",children:e.jsxs("div",{className:"flex items-center bg-yellow-50 border-l-4 border-yellow-400 px-2 py-1 rounded",children:[e.jsx("span",{className:"text-xs text-yellow-700 font-semibold mr-2",children:"✏️ Editing message:"}),e.jsx("span",{className:"text-xs text-yellow-600 truncate",children:L}),e.jsx("button",{className:"ml-auto text-yellow-400 hover:text-yellow-700",onClick:()=>{O(null),G(""),q("")},title:"Cancel edit",children:"×"})]})}),e.jsxs("div",{className:"flex gap-2 mt-2 px-4 pb-4",children:[e.jsx("input",{type:"text",className:"flex-1 px-3 py-2 border rounded-full text-sm focus:ring-2 focus:ring-blue-200 shadow",placeholder:k?"Edit your message...":"Type a message...",value:te,onChange:t=>{q(t.target.value),k&&G(t.target.value),k||p.emit("typing",{toUserId:c._id,fromUserId:g._id,appointmentId:s._id})},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),k?tt(k):et())},ref:y}),e.jsx("button",{onClick:k?()=>tt(k):et,disabled:(k?ce===k:ye)||!te.trim(),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-5 py-2 rounded-full text-sm font-semibold shadow hover:from-blue-600 hover:to-purple-600 transition disabled:opacity-50 flex items-center gap-2 min-w-20",children:k?ce===k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save":ye?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border border-white border-t-transparent rounded-full animate-spin"}),"Sending..."]}):"Send"})]}),e.jsx("style",{jsx:!0,children:`
                  @keyframes fadeInChatBubble {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                  }
                  .animate-fadeInChatBubble {
                    animation: fadeInChatBubble 0.4s cubic-bezier(0.4,0,0.2,1) both;
                  }
                  @keyframes fadeInChat {
                    from { opacity: 0; }
                    to { opacity: 1; }
                  }
                  .animate-fadeInChat {
                    animation: fadeInChat 0.3s cubic-bezier(0.4,0,0.2,1) both;
                  }
                `})]}),!P&&!H&&!k&&!ee&&e.jsx("div",{className:"absolute bottom-20 right-6 z-20",children:e.jsxs("button",{onClick:Mt,className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full p-3 shadow-lg transition-all duration-200 hover:scale-110 relative",title:F>0?`${F} new message${F>1?"s":""}`:"Scroll to bottom","aria-label":F>0?`${F} new messages, scroll to bottom`:"Scroll to bottom",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"transform",children:e.jsx("path",{d:"M12 16l-6-6h12l-6 6z"})}),F>0&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full min-w-[20px] h-5 flex items-center justify-center px-1 border-2 border-white shadow-lg",children:F>99?"99+":F})]})})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"text-red-500"}),"Delete Message"]}),C!=null&&C.deleted?e.jsx("p",{className:"text-gray-600 mb-6",children:"Delete this message for me?"}):(C==null?void 0:C.senderEmail)===g.email?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to delete this message?"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ie,onChange:t=>V(t.target.checked),className:"form-checkbox h-4 w-4 text-red-600 rounded border-gray-300 focus:ring-red-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Also delete for"," ",e.jsx("span",{className:"font-medium text-gray-900",children:(c==null?void 0:c.username)||"other user"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-7",children:ie?"The message will be permanently deleted for everyone":"The message will only be deleted for you"})]})]}):e.jsxs("p",{className:"text-gray-600 mb-6",children:["Delete message from"," ",e.jsx("span",{className:"font-medium text-gray-900",children:(c==null?void 0:c.username)||"other user"}),"?"]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{B(!1),E(null),V(!0)},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:At,className:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(D,{size:12}),C!=null&&C.deleted?"Delete for me":(C==null?void 0:C.senderEmail)===g.email&&ie?"Delete for everyone":"Delete for me"]})]})]})}),Re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"text-red-500"}),"Clear Chat"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to clear chat? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>ue(!1),className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:kt,className:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(D,{size:12}),"Clear Chat"]})]})]})}),Be&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"text-red-500"}),"Delete Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to delete this appointment?"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for deletion (required):"}),e.jsx("textarea",{value:vt,onChange:t=>Xe(t.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:"3",placeholder:"Please provide a reason for deleting this appointment..."})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{Ee(!1),Pe(null),Xe("")},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:confirmAdminDelete,className:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(D,{size:12}),"Delete Appointment"]})]})]})}),ht&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ge,{className:"text-blue-500"}),"Archive Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to archive this appointment? It will be moved to the archived section."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{gt(!1),Pe(null)},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:confirmArchive,className:"px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(Ge,{size:12}),"Archive"]})]})]})}),ft&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ye,{className:"text-green-500"}),"Unarchive Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to unarchive this appointment? It will be moved back to the active appointments."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{bt(!1),Pe(null)},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:confirmUnarchive,className:"px-4 py-2 rounded bg-green-600 text-white font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(Ye,{size:12}),"Unarchive"]})]})]})}),pt&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ce,{className:"text-orange-500"}),"Cancel Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to cancel this appointment?"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for cancellation ",M?"(required)":"(optional)",":"]}),e.jsx("textarea",{value:xe,onChange:t=>W(t.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",rows:"3",placeholder:M?"Please provide a reason for cancelling...":"Optional reason for cancelling..."})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{$e(!1),W("")},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:Dt,className:"px-4 py-2 rounded bg-orange-600 text-white font-semibold hover:bg-orange-700 transition-colors flex items-center gap-2",children:[e.jsx(Ce,{size:12}),"Cancel Appointment"]})]})]})}),yt&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ce,{className:"text-red-500"}),"Admin Cancel Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to cancel this appointment as admin?"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for admin cancellation (required):"}),e.jsx("textarea",{value:xe,onChange:t=>W(t.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:"3",placeholder:"Please provide a reason for admin cancellation..."})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{Le(!1),W("")},className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:Rt,className:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(Ce,{size:12}),"Cancel as Admin"]})]})]})}),jt&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"text-red-500"}),"Remove Appointment"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to permanently remove this appointment from your table? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>ze(!1),className:"px-4 py-2 rounded bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:Bt,className:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(D,{size:12}),"Remove Permanently"]})]})]})})]})}export{ss as default};
