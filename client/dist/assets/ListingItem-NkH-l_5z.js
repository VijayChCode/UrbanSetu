import{O as j,r as h,u as v,h as w,g,j as t,R as $,z as I,L as k,y as u}from"./index-BWEopvPR.js";import{M as L}from"./index-xJ9jhbIX.js";import{m as P}from"./addressMasking-3vIUwCOC.js";function C({listing:e,onDelete:l}){const{addToWishlist:f,removeFromWishlist:b,isInWishlist:i}=j(),[a,m]=h.useState(!1),d=v(),p=w(),{currentUser:r}=g(s=>s.user),x=p.pathname.includes("/admin");h.useEffect(()=>{m(i(e._id))},[i,e._id]);const y=async()=>{if(!r){u.info("Please sign in to add properties to your wishlist."),d("/sign-in");return}a?(await b(e._id),m(!1)):(await f(e),m(!0))},N=()=>{if(!r){u.info("Please sign in to book appointments."),d("/sign-in");return}const s=x?`/admin/appointmentlisting?listingId=${e._id}&listingType=${e.type}&propertyName=${encodeURIComponent(e.name)}&propertyDescription=${encodeURIComponent(e.description)}`:`/user/appointment?listingId=${e._id}&listingType=${e.type}&propertyName=${encodeURIComponent(e.name)}&propertyDescription=${encodeURIComponent(e.description)}`;d(s)},n=s=>`₹${Number(s).toLocaleString("en-IN")}`,o=()=>e.offer&&e.regularPrice&&e.discountPrice?Math.round((e.regularPrice-e.discountPrice)/e.regularPrice*100):0;let c=`/listing/${e._id}`;return x?c=`/admin/listing/${e._id}`:p.pathname.startsWith("/user")&&(c=`/user/listing/${e._id}`),t.jsxs("div",{className:"relative bg-white shadow-md rounded-lg overflow-hidden p-2 sm:p-4",children:[e.offer&&o()>0&&t.jsx("div",{className:"absolute top-2 sm:top-4 left-2 sm:left-4 z-20",children:t.jsxs("span",{className:"bg-yellow-400 text-gray-900 text-xs font-semibold px-2 py-1 rounded-full shadow-md animate-pulse",title:"Limited-time offer!",children:[o(),"% OFF"]})}),t.jsx("button",{onClick:y,className:`absolute top-2 sm:top-4 right-2 sm:right-4 p-2 rounded-full transition z-20 ${a?"bg-red-500 text-white":"bg-gray-200 text-red-500"}`,title:a?"Remove from wishlist":"Add to wishlist",children:t.jsx($,{className:"text-base sm:text-lg"})}),l&&t.jsx("button",{onClick:()=>l(e._id),className:"absolute top-2 sm:top-4 left-2 sm:left-4 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-500 hover:text-white transition shadow-md z-10",title:"Delete Listing",style:{left:e.offer&&o()>0?"4.5rem":"0.5rem"},children:t.jsx(I,{className:"text-base sm:text-lg"})}),t.jsxs(k,{to:c,children:[e.imageUrls&&e.imageUrls.length>0?t.jsx("img",{src:e.imageUrls[0],alt:"home",className:"w-full h-32 sm:h-48 object-cover rounded-md",onError:s=>{s.target.src="https://via.placeholder.com/400x300?text=No+Image",s.target.className="w-full h-32 sm:h-48 object-cover rounded-md opacity-50"}}):t.jsx("div",{className:"w-full h-48 bg-gray-200 rounded-md flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500",children:[t.jsx("div",{className:"text-4xl mb-2",children:"🏠"}),t.jsx("p",{className:"text-sm",children:"No Image"})]})}),t.jsxs("div",{className:"p-2 sm:p-3",children:[t.jsx("p",{className:"text-gray-700 font-semibold text-base sm:text-lg truncate",children:e.name}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[t.jsx(L,{className:"text-red-500"}),t.jsx("p",{className:"truncate",children:P(e.propertyNumber||e.city?{propertyNumber:e.propertyNumber,landmark:e.landmark,city:e.city,district:e.district,state:e.state,pincode:e.pincode}:e.address,!!r)})]}),t.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-2 truncate",children:e.description}),t.jsx("div",{className:"mt-2",children:e.offer&&o()>0?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("p",{className:"text-base sm:text-lg font-bold text-blue-500",children:[n(e.discountPrice),e.type==="rent"&&" / month"]}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-500 line-through",children:n(e.regularPrice)})]}):t.jsxs("p",{className:"text-base sm:text-lg font-bold text-blue-500",children:[n(e.regularPrice),e.type==="rent"&&" / month"]})}),t.jsxs("div",{className:"flex space-x-2 sm:space-x-4 text-gray-600 text-xs sm:text-sm mt-2",children:[t.jsx("p",{children:e.bedrooms>1?`${e.bedrooms} beds`:`${e.bedrooms} bed`}),t.jsx("p",{children:e.bathrooms>1?`${e.bathrooms} bathrooms`:`${e.bathrooms} bathroom`})]})]})]}),t.jsx("div",{className:"mt-2 sm:mt-4",children:r&&r._id===e.userRef?t.jsx("div",{className:"w-full text-red-500 font-semibold text-center py-2 sm:py-3 rounded-lg bg-red-50 border border-red-200",children:"You cannot book an appointment for your own property."}):t.jsx("button",{onClick:N,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center justify-center gap-2 text-sm sm:text-base",children:"📅 Book Appointment"})})]})}export{C as L};
