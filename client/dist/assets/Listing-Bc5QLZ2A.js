import{h as L,a as P,u as I,b as F,r as c,j as e,L as u,i as C,k as S,l as D,m as $,n as A,o as B,p as E,q as R,t as T,C as U}from"./index-crh2KQ3K.js";import{S as _,N as M,a as b}from"./navigation-cXriADjO.js";import{s as f,m as H,g as j}from"./addressMasking-3vIUwCOC.js";function Y(){const p=L(),n=P(),N=I(),{currentUser:s}=F(r=>r.user),[t,y]=c.useState(null),[v,h]=c.useState(!1),[w,g]=c.useState(!0),m=(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="rootadmin",l=N.pathname.includes("/admin"),o=s?l?{path:"/admin",text:"Back to Dashboard"}:{path:"/user",text:"Back to Home"}:{path:"/",text:"Back to Home"},d=r=>`₹${Number(r).toLocaleString("en-IN")}`,x=()=>t.offer&&t.regularPrice&&t.discountPrice?Math.round((t.regularPrice-t.discountPrice)/t.regularPrice*100):0,k=async()=>{if(window.confirm("Are you sure you want to delete this property?"))try{const r=await fetch(`/api/listing/delete/${t._id}`,{method:"DELETE",credentials:"include"});if(r.ok)alert("Property deleted successfully!"),n("/admin/my-listings");else{const a=await r.json();alert(a.message||"Failed to delete property.")}}catch(r){console.error("Error deleting property:",r),alert("An error occurred while deleting the property.")}};return c.useEffect(()=>{(async()=>{g(!0);try{const i=await(await fetch(`/api/listing/get/${p.listingId}`)).json();if(i.success===!1){console.log(i.message);return}y(i)}catch(a){console.error("Error fetching listing:",a)}finally{g(!1)}})()},[p.listingId]),w?e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"ml-3 text-lg font-semibold text-blue-600",children:"Loading property details..."})]})})}):t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>n(o.path),className:"flex items-center gap-2 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(C,{})," ",o.text]})}),m&&l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(u,{to:`/admin/update-listing/${t._id}`,className:"flex items-center gap-2 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(S,{})," Edit Property"]}),e.jsxs("button",{onClick:k,className:"flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:[e.jsx(D,{})," Delete Property"]})]})]}),e.jsxs("h3",{className:"text-3xl font-extrabold text-blue-700 mb-6 text-center drop-shadow",children:["Property Details ",m&&l&&"(Admin View)"]}),e.jsx(_,{navigation:!0,modules:[M],className:"rounded-lg overflow-hidden relative mb-6",children:t.imageUrls&&t.imageUrls.length>0?t.imageUrls.map((r,a)=>e.jsx(b,{children:e.jsx("img",{src:r,alt:`${t.name} - Image ${a+1}`,className:"w-full h-64 md:h-96 object-cover",onError:i=>{i.target.src="https://via.placeholder.com/800x600?text=Image+Not+Available",i.target.className="w-full h-64 md:h-96 object-cover opacity-50"}})},a)):e.jsx(b,{children:e.jsx("div",{className:"w-full h-64 md:h-96 bg-gray-200 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏠"}),e.jsx("p",{className:"text-lg",children:"No images available"})]})})})}),e.jsx("div",{className:"flex justify-end items-center space-x-4 mb-4 pr-2",children:e.jsx($,{className:"cursor-pointer text-gray-500 hover:text-gray-700 text-xl",onClick:()=>{navigator.clipboard.writeText(window.location.href),h(!0),setTimeout(()=>h(!1),2e3)}})}),v&&e.jsx("p",{className:"text-green-500 text-sm text-center mb-4",children:"Link copied!"}),e.jsxs("div",{className:"p-6 bg-gray-50 shadow-md rounded-lg mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:t.name}),t.offer&&x()>0&&e.jsxs("span",{className:"bg-yellow-400 text-gray-900 text-sm font-semibold px-3 py-1 rounded-full shadow-md animate-pulse",title:"Limited-time offer!",children:[x(),"% OFF"]})]}),e.jsx("div",{className:"mb-4",children:t.offer&&x()>0?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"text-3xl text-blue-600 font-semibold",children:[d(t.discountPrice),t.type==="rent"&&" / month"]}),e.jsx("p",{className:"text-xl text-gray-500 line-through",children:d(t.regularPrice)}),e.jsxs("span",{className:"text-sm text-green-600 font-semibold",children:["Save ",d(t.regularPrice-t.discountPrice)]})]}):e.jsxs("p",{className:"text-3xl text-blue-600 font-semibold",children:[d(t.regularPrice),t.type==="rent"&&" / month"]})}),e.jsxs("p",{className:"flex items-center text-gray-600 mb-4",children:[e.jsx(A,{className:"mr-2 text-red-500"}),H(t.propertyNumber||t.city?{propertyNumber:t.propertyNumber,landmark:t.landmark,city:t.city,district:t.district,state:t.state,pincode:t.pincode}:t.address,!!s)]}),t.locationLink&&f(!!s)&&e.jsx("div",{className:"mb-4",children:e.jsx("a",{href:t.locationLink,target:"_blank",rel:"noopener noreferrer",className:"inline-block bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition",children:j(!!s)})}),t.locationLink&&!f(!!s)&&e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>n("/sign-in"),className:"inline-block bg-gray-400 text-white px-4 py-2 rounded cursor-pointer",children:j(!!s)})}),e.jsx("div",{className:"flex space-x-4 mb-4",children:e.jsx("span",{className:`px-3 py-1 text-white rounded-md ${t.type==="rent"?"bg-blue-500":"bg-green-500"}`,children:t.type==="rent"?"For Rent":"For Sale"})}),e.jsxs("p",{className:"text-gray-700 mb-4 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"Description:"})," ",t.description]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(B,{className:"mr-2 text-blue-500"})," ",t.bedrooms," ",t.bedrooms>1?"beds":"bed"]}),e.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(E,{className:"mr-2 text-blue-500"})," ",t.bathrooms," ",t.bathrooms>1?"baths":"bath"]}),e.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(R,{className:"mr-2 text-blue-500"})," ",t.parking?"Parking":"No Parking"]}),e.jsxs("div",{className:"flex items-center p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(T,{className:"mr-2 text-blue-500"})," ",t.furnished?"Furnished":"Unfurnished"]})]})]}),m&&l&&e.jsxs("div",{className:"p-6 bg-blue-50 shadow-md rounded-lg mb-6",children:[e.jsx("h4",{className:"text-xl font-bold text-blue-800 mb-4",children:"Admin Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Property ID"}),e.jsx("p",{className:"font-semibold text-gray-800",children:t._id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Created Date"}),e.jsx("p",{className:"font-semibold text-gray-800",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Updated"}),e.jsx("p",{className:"font-semibold text-gray-800",children:new Date(t.updatedAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Created By"}),e.jsx("p",{className:"font-semibold text-gray-800",children:t.userRef||"Unknown"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:s&&(t.sellerId===s._id||t.userRef===s._id)?e.jsx("div",{className:"text-red-500 font-semibold text-lg py-3",children:"You cannot book an appointment for your own property."}):e.jsx("button",{onClick:()=>{if(!s){n("/sign-in");return}const r=l?`/admin/appointmentlisting?listingId=${t._id}&propertyName=${encodeURIComponent(t.name)}&propertyDescription=${encodeURIComponent(t.description)}&listingType=${t.type}`:`/user/appointment?listingId=${t._id}&propertyName=${encodeURIComponent(t.name)}&propertyDescription=${encodeURIComponent(t.description)}&listingType=${t.type}`;n(r)},className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2",children:"📅 Book Appointment"})})]})}),e.jsx(U,{})]}):e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:e.jsx("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 relative",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-4",children:"Property Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The property you're looking for doesn't exist or has been removed."}),e.jsx(u,{to:o.path,className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:o.text})]})})})}export{Y as default};
