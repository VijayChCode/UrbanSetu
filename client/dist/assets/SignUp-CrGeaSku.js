import{r as a,u as re,g as le,j as e,t as F,v as ne,l as Y,m as W,L as V}from"./index-CjQdFyIh.js";import ie from"./Oauth-MNVQr8WV.js";import{C as oe}from"./ContactSupportWrapper-euXpojhz.js";const A="https://urbansetu.onrender.com";function ue({bootstrapped:L,sessionChecked:M}){const[r,G]=a.useState({username:"",email:"",password:"",confirmPassword:"",role:"",mobileNumber:""}),[n,K]=a.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,specialChar:!1}),[C,Q]=a.useState(!1),[O,X]=a.useState(!1),[$,o]=a.useState(""),[d,p]=a.useState({email:"",mobileNumber:""}),[q,m]=a.useState(!1),[D,c]=a.useState(""),b=re(),{currentUser:g}=le(s=>s.user),[R,ee]=a.useState(!1),[l,H]=a.useState(!1),[y,E]=a.useState(!1),[j,k]=a.useState(""),[N,U]=a.useState(!1),[I,Z]=a.useState(!1),[v,i]=a.useState(""),[u,_]=a.useState(!1),[h,w]=a.useState(0),[J,S]=a.useState(!0),se=s=>{const t={length:s.length>=8,uppercase:/[A-Z]/.test(s),lowercase:/[a-z]/.test(s),number:/[0-9]/.test(s),specialChar:/[^A-Za-z0-9]/.test(s)};K(t)};a.useEffect(()=>{let s=null;return h>0&&(s=setInterval(()=>{w(t=>t<=1?(S(!0),0):t-1)},1e3)),()=>{s&&clearInterval(s)}},[h]);const x=s=>{const{id:t,value:P}=s.target;G({...r,[t]:P}),(t==="email"||t==="mobileNumber")&&p(z=>({...z,[t]:""})),t==="email"&&(u?(H(!1),E(!1),k(""),i(""),w(0),S(!0),_(!1)):l||(E(!1),k(""),i(""),w(0),S(!0))),t==="password"&&se(P)},B=async()=>{if(!r.email){i("Please enter an email address first");return}if(J){U(!0),i("");try{const t=await(await fetch(`${A}/api/auth/send-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email})})).json();t.success?(E(!0),c("OTP sent successfully to your email"),setTimeout(()=>c(""),3e3),w(30),S(!1)):i(t.message)}catch{i("Failed to send OTP. Please try again.")}finally{U(!1)}}},te=async()=>{if(!j){i("Please enter the OTP");return}Z(!0),i("");try{const t=await(await fetch(`${A}/api/auth/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,otp:j})})).json();t.success?(H(!0),c("Email verified successfully!"),setTimeout(()=>c(""),3e3)):i(t.message)}catch{i("Failed to verify OTP. Please try again.")}finally{Z(!1)}},ae=async s=>{if(s.preventDefault(),!R){o("You must agree to the Terms of Use and Privacy Policy.");return}if(!l){o("Please verify your email address before creating an account.");return}if(m(!0),o(""),c(""),p({email:"",mobileNumber:""}),r.password!==r.confirmPassword){o("Passwords are not matching"),m(!1);return}if(!r.role){o("Please select a role"),m(!1);return}try{const t=`${A}/api/auth/signup`,P={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,emailVerified:!0})},f=await(await fetch(t,P)).json();if(f.success===!1)f.message.includes("email already exists")?p(T=>({...T,email:f.message})):f.message.includes("mobile number already exists")?p(T=>({...T,mobileNumber:f.message})):o(f.message),m(!1);else{o(""),m(!1),r.role==="admin"||r.role==="rootadmin"?c("Admin account created successfully. Please wait for an existing admin to approve your request."):c("Account created successfully, please sign in!"),setTimeout(()=>{c(""),b("/sign-in")},2e3);return}}catch(t){o(t.message),m(!1)}};return a.useEffect(()=>{L&&M&&g&&(g.role==="admin"||g.role==="rootadmin"?b("/admin",{replace:!0}):b("/user",{replace:!0}))},[L,M,g,b]),e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-green-600 to-blue-700 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-20"}),e.jsx("div",{className:"relative z-10 flex flex-col justify-center items-center text-white p-12",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 animate-fade-in",children:"Join Our Community"}),e.jsx("p",{className:"text-xl mb-8 leading-relaxed animate-fade-in-delay",children:`"Every house has a story. Let's write yours together."`}),e.jsxs("div",{className:"space-y-4 text-lg animate-fade-in-delay-2",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsx("span",{children:"Find Your Perfect Home"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),e.jsx("span",{children:"List Your Properties"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse",style:{animationDelay:"1s"}}),e.jsx("span",{children:"Connect with Buyers & Sellers"})]})]})]})}),e.jsx("div",{className:"absolute top-20 left-20 w-16 h-16 bg-white bg-opacity-10 rounded-full animate-float"}),e.jsx("div",{className:"absolute bottom-32 right-16 w-12 h-12 bg-white bg-opacity-10 rounded-full animate-float",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/2 right-24 w-8 h-8 bg-white bg-opacity-10 rounded-full animate-float",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-black bg-opacity-20",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M10 2L2 8V18H18V8L10 2Z",fill:"white",fillOpacity:"0.1"}),e.jsx("path",{d:"M8 12H12V18H8V12Z",fill:"white",fillOpacity:"0.2"}),e.jsx("circle",{cx:"10",cy:"5",r:"1",fill:"white",fillOpacity:"0.3"}),e.jsx("path",{d:"M15 6L18 8V18H22V8L15 6Z",fill:"white",fillOpacity:"0.1"}),e.jsx("path",{d:"M17 12H20V18H17V12Z",fill:"white",fillOpacity:"0.2"})]})})]}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-8 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Create Account"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Join thousands of users finding their perfect homes"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-4 sm:p-8 border border-gray-100",children:[e.jsxs("form",{onSubmit:ae,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",placeholder:"Enter your full name",id:"username",onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address",l&&e.jsx("span",{className:"ml-2 text-green-600",children:e.jsx(F,{className:"inline"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",placeholder:"Enter your email",id:"email",value:r.email,onChange:x,readOnly:l&&!u,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 ${l&&!u?"bg-gray-100 cursor-not-allowed border-green-500":d.email?"border-red-500":l?"border-green-500":"border-gray-300"}`,required:!0}),d.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.email}),!l&&!y&&!u&&e.jsx("button",{type:"button",onClick:B,disabled:N||!J||!r.email,className:"absolute right-3 top-1/2 -translate-y-1/2 px-3 py-1 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Sending...":"Send OTP"}),l&&!u&&e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>_(!0),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Edit email",children:e.jsx(ne,{className:"text-sm"})}),e.jsx("div",{className:"text-green-600",children:e.jsx(F,{className:"text-xl"})})]}),l&&u&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"text-green-600",children:e.jsx(F,{className:"text-xl"})})})]}),y&&!l&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["OTP sent to ",r.email]}),v&&!y&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:v})]}),y&&!l&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{type:"text",placeholder:"Enter 6-digit OTP",id:"otp",value:j,onChange:s=>k(s.target.value),maxLength:"6",className:"flex-1 px-3 py-2 sm:px-4 sm:py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm sm:text-base"}),e.jsx("button",{type:"button",onClick:te,disabled:I||!j,className:"px-3 py-2 sm:px-4 sm:py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 text-sm sm:text-base whitespace-nowrap",children:I?"Verifying...":"Verify"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Enter the 6-digit code sent to your email"}),e.jsx("div",{className:"flex items-center gap-2",children:h>0?e.jsxs("span",{className:"text-xs text-gray-500",children:["Resend in ",Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]}):e.jsx("button",{type:"button",onClick:B,disabled:N,className:"text-xs text-blue-600 hover:text-blue-800 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Sending...":"Resend OTP"})})]}),v&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobileNumber",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number"}),e.jsx("input",{type:"tel",placeholder:"Enter 10-digit mobile number",id:"mobileNumber",onChange:x,pattern:"[0-9]{10}",maxLength:"10",className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 ${d.mobileNumber?"border-red-500":"border-gray-300"}`,required:!0}),d.mobileNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.mobileNumber})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I want to"}),e.jsxs("select",{id:"role",onChange:x,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:[e.jsx("option",{value:"",children:"Select your role"}),e.jsx("option",{value:"user",children:"Buy/Sell Properties"}),e.jsx("option",{value:"admin",children:"Manage Platform (Admin)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:C?"text":"password",placeholder:"Create a strong password",id:"password",onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:()=>Q(!C),children:C?e.jsx(Y,{className:"text-gray-600"}):e.jsx(W,{className:"text-gray-600"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Password Requirements:"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsxs("p",{className:`flex items-center ${n.length?"text-green-600":"text-red-500"}`,children:[n.length?"✔️":"❌"," Minimum 8 characters"]}),e.jsxs("p",{className:`flex items-center ${n.uppercase?"text-green-600":"text-red-500"}`,children:[n.uppercase?"✔️":"❌"," At least one uppercase letter"]}),e.jsxs("p",{className:`flex items-center ${n.lowercase?"text-green-600":"text-red-500"}`,children:[n.lowercase?"✔️":"❌"," At least one lowercase letter"]}),e.jsxs("p",{className:`flex items-center ${n.number?"text-green-600":"text-red-500"}`,children:[n.number?"✔️":"❌"," At least one number"]}),e.jsxs("p",{className:`flex items-center ${n.specialChar?"text-green-600":"text-red-500"}`,children:[n.specialChar?"✔️":"❌"," At least one special character"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:O?"text":"password",placeholder:"Confirm your password",id:"confirmPassword",onChange:x,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:()=>X(!O),children:O?e.jsx(Y,{className:"text-gray-600"}):e.jsx(W,{className:"text-gray-600"})})]})]}),e.jsxs("div",{className:"flex items-start mb-2",children:[e.jsx("input",{type:"checkbox",id:"consent",checked:R,onChange:s=>ee(s.target.checked),className:"mt-1 mr-2",required:!0}),e.jsxs("label",{htmlFor:"consent",className:"text-sm text-gray-700 select-none",children:["I agree to the ",e.jsx(V,{to:"/terms",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",onClick:s=>{s.preventDefault(),window.open("/terms","_blank","noopener,noreferrer")},children:"Terms of Use"})," and ",e.jsx(V,{to:"/privacy",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",onClick:s=>{s.preventDefault(),window.open("/privacy","_blank","noopener,noreferrer")},children:"Privacy Policy"}),"."]})]}),e.jsx("button",{disabled:q||Object.values(n).includes(!1)||!l,className:"w-full py-3 px-4 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold rounded-lg hover:from-green-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105",children:q?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating Account..."]}):"Create Account"}),D&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:e.jsx("p",{className:"text-green-700 text-sm font-semibold",children:D})}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsx(ie,{pageType:"signUp"}),$&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600 text-sm",children:$})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx(V,{to:"/sign-in",className:"text-blue-600 hover:text-blue-800 font-semibold hover:underline transition-colors duration-200",children:"Sign In"})]})})]})]})}),e.jsx(oe,{})]})}export{ue as default};
