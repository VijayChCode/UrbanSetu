import{b as ds,v as cs,c as ms,r,a as us,j as e,P as q,E as Ce,G as Pe,k as ke,Q as Ee,B as Te,M as Ae,D as fs,H as re,I as Q,L as De,S as hs,T as xs,l as gs,C as bs,U as ps,W as M,X as ys,Y as js,Z as S,_ as p,$ as C,a0 as Ue,a1 as Fe,a2 as ws}from"./index-crh2KQ3K.js";function Ss(){const{currentUser:a,error:vs}=ds(s=>s.user),{wishlist:le}=cs(),n=ms(),[u,ie]=r.useState({}),[Me,G]=r.useState(!1),[ne,R]=r.useState(""),[y,K]=r.useState(!1),[X,_]=r.useState({listings:0,appointments:0,wishlist:0}),[Z,$]=r.useState(!1),[oe,Re]=r.useState([]),[L,_e]=r.useState(""),[de,O]=r.useState(!1),[I,ce]=r.useState(!1),[$e,P]=r.useState(!1),[ee,me]=r.useState(""),[ue,k]=r.useState(""),[Le,E]=r.useState(!1),[z,fe]=r.useState(""),[he,W]=r.useState(""),[Oe,T]=r.useState(!1),[xe,se]=r.useState([]),[V,ge]=r.useState(""),[Y,be]=r.useState(""),[pe,j]=r.useState(""),[ye,je]=r.useState(!1),[B,A]=r.useState(""),[H,w]=r.useState(""),[D,f]=r.useState(!1),[Ie,h]=r.useState(!1),[ae,x]=r.useState(""),[we,J]=r.useState(""),[o,v]=r.useState({loading:!1,message:"",available:null}),[d,N]=r.useState({loading:!1,message:"",available:null}),[U,ze]=r.useState(null),[F,We]=r.useState(null),[Ve,Ye]=r.useState(""),[Be,He]=r.useState(""),c=us();window.location.pathname.startsWith("/admin"),r.useEffect(()=>{a&&(Ye(a.email||""),He(a.mobileNumber||""))},[a]),r.useEffect(()=>{a&&Je()},[a]),r.useEffect(()=>{a&&_(s=>({...s,wishlist:le.length}))},[le,a]),r.useEffect(()=>()=>{U&&clearTimeout(U),F&&clearTimeout(F)},[U,F]);const Je=async()=>{try{if(a&&(a.role==="admin"||a.role==="rootadmin")){const[s,t]=await Promise.all([fetch("/api/listing/user",{credentials:"include"}),fetch("/api/bookings/",{credentials:"include"})]),i=await s.json(),l=await t.json();_(g=>({listings:Array.isArray(i)?i.filter(m=>m.userRef===a._id).length:0,appointments:Array.isArray(l)?l.length:0,wishlist:g.wishlist}))}else{const[s,t]=await Promise.all([fetch("/api/listing/user",{credentials:"include"}),fetch(`/api/bookings/user/${a._id}`,{credentials:"include"})]),i=await s.json(),l=await t.json();_(g=>({listings:Array.isArray(i)?i.length:0,appointments:l.count||0,wishlist:g.wishlist}))}}catch(s){console.error("Error fetching user stats:",s),_(t=>({listings:0,appointments:0,wishlist:t.wishlist}))}},ve=async s=>{if(!s.trim()){v({loading:!1,message:"",available:null});return}if(!s.includes("@")){v({loading:!1,message:"Enter a valid email",available:!1});return}if(s===Ve){v({loading:!1,message:"",available:!0});return}try{v({loading:!0,message:"",available:null});const i=await(await fetch(`/api/user/check-email/${encodeURIComponent(s.trim())}`,{credentials:"include"})).json();v({loading:!1,message:i.message,available:i.available})}catch{v({loading:!1,message:"Error checking email availability",available:!1})}},Ne=async s=>{if(!s.trim()){N({loading:!1,message:"",available:null});return}if(!/^[0-9]{10}$/.test(s)){N({loading:!1,message:"Enter a valid 10-digit mobile number",available:!1});return}if(s===Be){N({loading:!1,message:"",available:!0});return}try{N({loading:!0,message:"",available:null});const i=await(await fetch(`/api/user/check-mobile/${encodeURIComponent(s.trim())}`,{credentials:"include"})).json();N({loading:!1,message:i.message,available:i.available})}catch{N({loading:!1,message:"Error checking mobile availability",available:!1})}},qe=s=>{U&&clearTimeout(U);const t=setTimeout(()=>ve(s),300);ze(t)},Qe=s=>{F&&clearTimeout(F);const t=setTimeout(()=>Ne(s),300);We(t)},te=s=>{const{id:t,value:i}=s.target;ie({...u,[t]:i}),t==="email"?A(""):t==="mobileNumber"&&w(""),t==="email"?qe(i):t==="mobileNumber"&&Qe(i)},Ge=async s=>{if(s.preventDefault(),R(""),G(!1),A(""),w(""),!u.email||!u.email.trim()){A("Please provide valid email id");return}if(o.available===!1){A("Email already exists. Please use a different one.");return}if(d.available===!1){w("Mobile number already exists. Please use a different one.");return}if(!u.mobileNumber||!/^[0-9]{10}$/.test(u.mobileNumber)){w("Please provide a valid 10-digit mobile number");return}h(!0)},Ke=async()=>{if(J(""),!ae){J("Password is required");return}f(!0);try{n(ps());const s=`/api/user/update/${a._id}`,t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,password:ae})},l=await(await fetch(s,t)).json();if(console.log("Profile update response:",l),l.status==="email_exists"){alert("Email already registered. Please use a different one."),A("Email already registered. Please use a different one."),n(M("Email already registered. Please use a different one.")),f(!1),h(!1),x("");return}if(l.status==="mobile_exists"){alert("Mobile number already in use. Please choose another one."),w("Mobile number already in use. Please choose another one."),n(M("Mobile number already in use. Please choose another one.")),f(!1),h(!1),x("");return}if(l.status==="mobile_invalid"){w("Please provide a valid 10-digit mobile number"),n(M("Please provide a valid 10-digit mobile number")),f(!1),h(!1),x("");return}if(l.status==="invalid_password"){console.log("Invalid password detected"),J("Incorrect password. Profile details unchanged."),f(!1);return}if(l.status==="success"){n(ys(l.updatedUser)),G(!0),K(!1),f(!1),h(!1),x(""),alert("Profile Updated Successfully!!"),setTimeout(()=>{G(!1)},3e3);return}if(l.success===!1||l.status==="error"){R(l.message||"Profile Update Failed!"),n(M(l.message)),f(!1),h(!1),x("");return}console.log("Unexpected response:",l),R("Profile Update Failed!"),f(!1),h(!1),x("")}catch(s){console.log("Profile update error:",s),R("Profile Update Failed!"),n(M(s.message)),f(!1),h(!1),x("")}},Xe=async()=>{if(a.isDefaultAdmin){$(!0);return}P(!0)},Ze=async()=>{if(k(""),!ee){k("Password is required");return}try{n(js());const s=`/api/user/delete/${a._id}`,t={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:ee}),credentials:"include"},i=await fetch(s,t);let l={};try{l=await i.json()}catch{l={}}if(i.status===401){P(!1),alert("For your security, you've been signed out automatically."),n(S());const m=await(await fetch("/api/auth/signout")).json();m.success===!1?n(p(m.message)):n(C(m)),c("/sign-in");return}if(l.message&&l.message.toLowerCase().includes("password")){P(!1),alert("For your security, you've been signed out automatically."),n(S());const m=await(await fetch("/api/auth/signout")).json();m.success===!1?n(p(m.message)):n(C(m)),c("/sign-in");return}if(l.success===!1||i.status!==200){k(l.message||"Account deletion failed"),n(Ue(l.message));return}n(Fe(l)),P(!1),alert("Account deleted successfully. Thank you for being with us â€” we hope to serve you again in the future!"),c("/")}catch(s){k("Account deletion failed"),n(Ue(s.message))}},es=async()=>{try{O(!0);const s=await fetch(`/api/user/approved-admins/${a._id}`,{credentials:"include"}),t=await s.json();s.ok?Re(t):alert(t.message||"Failed to fetch admins")}catch{alert("Error fetching admins")}finally{O(!1)}},ss=async()=>{if(!L){alert("Please select an admin to transfer default admin rights to");return}E(!0)},as=async()=>{if(W(""),!z){W("Password is required");return}try{ce(!0);const s=await fetch(`/api/user/verify-password/${a._id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:z})});let t={};try{t=await s.json()}catch{t={}}if(s.status===401){E(!1),alert("Your session has expired. Please sign in again. No admin rights are Transferred"),n(S());const b=await(await fetch("/api/auth/signout")).json();b.success===!1?n(p(b.message)):n(C(b)),c("/sign-in");return}if(!s.ok||t.success===!1){E(!1),alert("For your security, you've been signed out automatically."),n(S());const b=await(await fetch("/api/auth/signout")).json();b.success===!1?n(p(b.message)):n(C(b)),c("/sign-in");return}const i=await fetch("/api/user/transfer-default-admin",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentAdminId:a._id,newDefaultAdminId:L})}),l=await i.json();if(!i.ok){alert(l.message||"Failed to transfer default admin rights");return}const g=await fetch(`/api/user/delete/${a._id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:z})}),m=await g.json();if(!g.ok){alert(m.message||"Failed to delete account after transfer");return}n(Fe(m)),$(!1),E(!1),alert("Admin rights are transferred and account deleted successfully!"),c("/")}catch{W("Account deletion failed")}finally{ce(!1)}},ts=async s=>{s.preventDefault();try{n(S());const i=await(await fetch("/api/auth/signout")).json();i.success===!1?n(p(i.message)):(n(C(i)),alert("You have been signed out."),await new Promise(l=>setTimeout(l,50)),c("/sign-in"))}catch(t){n(p(t.message))}},rs=()=>{a&&(a.role==="admin"||a.role==="rootadmin")?c("/admin/my-listings"):c("/user/my-listings")},ls=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});r.useEffect(()=>{Z&&es()},[Z]);const is=async()=>{try{O(!0);const s=await fetch("/api/admin/management/admins",{credentials:"include"}),t=await s.json();s.ok?se(t.filter(i=>i.role==="admin"||i.role==="rootadmin")):se([])}catch{se([])}finally{O(!1)}},ns=()=>{T(!0),j(""),be(""),ge(""),is()},os=async()=>{if(j(""),!V){j("Please select an admin to transfer rights to.");return}if(!Y){j("Password is required.");return}je(!0);try{const s=await fetch("/api/admin/transfer-rights",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({targetAdminId:V,password:Y})}),t=await s.json();if(s.status===401&&t.error==="invalidPassword"){T(!1),alert("For your security, you've been signed out automatically."),n(S());const l=await(await fetch("/api/auth/signout")).json();l.success===!1?n(p(l.message)):n(C(l)),c("/sign-in");return}if(!s.ok){j(t.message||"Failed to transfer rights.");return}ws.success(t.message||"Admin rights transferred successfully!"),T(!1),setTimeout(()=>window.location.reload(),1500)}catch{j("Failed to transfer rights.")}finally{je(!1)}};return r.useEffect(()=>{y&&a&&(ie({username:a.username||"",email:a.email||"",mobileNumber:a.mobileNumber?String(a.mobileNumber):"",avatar:a.avatar||""}),a.email&&ve(a.email),a.mobileNumber&&Ne(a.mobileNumber))},[y,a]),r.useEffect(()=>{async function s(){if(a&&a._id)try{const t=await fetch(`/api/user/id/${a._id}`);if(t.ok){const i=await t.json();n({type:"user/signInSuccess",payload:i})}}catch{}}s()},[]),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6 mb-4 md:mb-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{alt:"avatar",src:a.avatar,className:"h-24 w-24 rounded-full border-4 border-blue-200 object-cover shadow-lg"}),a.role==="admin"&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-purple-500 text-white rounded-full p-2",children:e.jsx(q,{className:"w-4 h-4"})}),a.isDefaultAdmin&&e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-red-500 text-white rounded-full p-2",children:e.jsx(q,{className:"w-3 h-3"})})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center",children:[a.username,a.role==="admin"&&e.jsx("span",{className:"ml-2 bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded-full font-medium",children:"Admin"}),a.isDefaultAdmin&&e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-sm px-3 py-1 rounded-full font-medium",children:"Default Admin"})]}),e.jsxs("p",{className:"text-gray-600 flex items-center",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),a.email]}),e.jsxs("p",{className:"text-gray-600 flex items-center",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),a.mobileNumber&&a.mobileNumber!=="0000000000"?`+91 ${a.mobileNumber.slice(0,5)} ${a.mobileNumber.slice(5)}`:"Mobile number not provided"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Member since ",ls(a.createdAt)]})]})]}),e.jsxs("button",{onClick:()=>K(!y),className:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),y?"Cancel Edit":"Edit Profile"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ee,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:X.listings}),e.jsx("p",{className:"text-gray-600",children:"My Listings"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Te,{className:"w-6 h-6 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:X.appointments}),e.jsx("p",{className:"text-gray-600",children:"Appointments"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-red-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ae,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:X.wishlist}),e.jsx("p",{className:"text-gray-600",children:"Wishlist Items"})]})]}),y&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[e.jsx(ke,{className:"w-5 h-5 mr-2 text-blue-600"}),"Edit Profile Information"]}),e.jsxs("form",{onSubmit:Ge,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Username"]}),e.jsx("input",{type:"text",id:"username",placeholder:"Enter username",value:u.username||"",onChange:te,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Email Address"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",id:"email",placeholder:"Enter email address",value:u.email||"",onChange:te,className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${o.available===!1?"border-red-500 focus:ring-red-500":o.available===!0?"border-green-500 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`}),o.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),o.available===!0&&!o.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(re,{className:"h-5 w-5 text-green-500"})}),o.available===!1&&!o.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(Q,{className:"h-5 w-5 text-red-500"})})]}),B&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:B}),o.message&&!B&&e.jsx("div",{className:`text-sm mt-1 ${o.available===!0?"text-green-600":o.available===!1?"text-red-600":"text-gray-600"}`,children:o.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Mobile Number"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"tel",id:"mobileNumber",placeholder:"Enter 10-digit mobile number",value:u.mobileNumber||"",onChange:te,pattern:"[0-9]{10}",maxLength:"10",className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${d.available===!1?"border-red-500 focus:ring-red-500":d.available===!0?"border-green-500 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`}),d.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),d.available===!0&&!d.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(re,{className:"h-5 w-5 text-green-500"})}),d.available===!1&&!d.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(Q,{className:"h-5 w-5 text-red-500"})})]}),H&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:H}),d.message&&!H&&e.jsx("div",{className:`text-sm mt-1 ${d.available===!0?"text-green-600":d.available===!1?"text-red-600":"text-gray-600"}`,children:d.message})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>K(!1),className:"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:`bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center ${D||o.loading||d.loading||o.available===!1||d.available===!1?"opacity-60 cursor-not-allowed":""}`,disabled:D||o.loading||d.loading||o.available===!1||d.available===!1,children:D?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Saving..."]}):"Save Changes"})]}),ne&&!B&&!H&&e.jsx("div",{className:"text-red-600 text-sm mt-3",children:ne})]})]}),!y&&Me&&e.jsx("div",{className:"text-green-600 text-sm mb-6",children:"Profile updated successfully!"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("button",{onClick:rs,className:"bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition-colors flex flex-col items-center",children:[e.jsx(Ee,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"My Listings"})]}),e.jsxs(De,{to:a.role==="admin"||a.role==="rootadmin"?"/admin/appointments":"/user/my-appointments",className:"bg-green-500 text-white p-3 rounded-lg hover:bg-green-600 transition-colors flex flex-col items-center",children:[e.jsx(Te,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"My Appointments"})]}),e.jsxs(De,{to:a.role==="admin"||a.role==="rootadmin"?"/admin/wishlist":"/user/wishlist",className:"bg-red-500 text-white p-3 rounded-lg hover:bg-red-600 transition-colors flex flex-col items-center",children:[e.jsx(Ae,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"My Wishlist"})]}),e.jsxs("button",{onClick:()=>c(a.role==="admin"||a.role==="rootadmin"?"/admin/change-password":"/user/change-password"),className:"bg-purple-500 text-white p-3 rounded-lg hover:bg-purple-600 transition-colors flex flex-col items-center cursor-pointer",children:[e.jsx(hs,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"Change Password"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Account Management"}),(a.role==="admin"||a.role==="rootadmin")&&e.jsx("button",{onClick:()=>c("/admin/management"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg mb-6 hover:bg-blue-700 transition-colors flex items-center justify-center font-semibold",children:"Accounts"}),a.isDefaultAdmin&&e.jsxs("button",{onClick:ns,className:"bg-yellow-500 text-white px-6 py-3 rounded-lg mb-6 hover:bg-yellow-600 transition-colors flex items-center justify-center font-semibold",style:{marginBottom:16},children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Transfer Rights"]}),a.isDefaultAdmin&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-blue-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-2",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Note:"})," You must transfer your default admin rights to another admin before you can delete your account."]})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:ts,className:"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors flex items-center justify-center",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Sign Out"]}),e.jsxs("button",{onClick:Xe,className:"bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center",children:[e.jsx(gs,{className:"w-4 h-4 mr-2"}),"Delete Account"]})]})]})]}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Default Admin Rights"}),e.jsx("button",{onClick:()=>$(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"As the default admin, you must select another approved admin to transfer your default admin rights before deleting your account."}),de?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):oe.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other approved admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot delete your account until another admin is approved."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:L,onChange:s=>_e(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose an admin..."}),oe.map(s=>e.jsxs("option",{value:s._id,children:[s.username," (",s.email,")"]},s._id))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>$(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ss,disabled:!L||I,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Transfer & Delete"]})})]})]})})}),$e&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm account deletion. This action cannot be undone."}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your password",value:ee,onChange:s=>me(s.target.value)}),ue&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:ue}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{P(!1),me(""),k("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ze,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:"Delete"})]})]})})}),Le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm account deletion after transferring default admin rights. This action cannot be undone."}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your password",value:z,onChange:s=>fe(s.target.value)}),he&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:he}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{E(!1),fe(""),W("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:as,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",disabled:I,children:I?"Processing...":"Transfer & Delete"})]})]})})}),Ie&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Profile Update"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm the profile changes."}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password",value:ae,onChange:s=>x(s.target.value)}),we&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:we}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{h(!1),x(""),J("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ke,disabled:D,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:D?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Profile"})]})]})})}),Oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Root Admin Rights"}),e.jsx("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Select an admin to transfer your root admin rights. You will remain an admin after transfer."}),de?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):xe.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot transfer rights until another admin exists."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:V,onChange:s=>ge(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose an admin..."}),xe.map(s=>e.jsxs("option",{value:s._id,children:[s.username," (",s.email,")"]},s._id))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password:"}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500",placeholder:"Enter your password",value:Y,onChange:s=>be(s.target.value)}),pe&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:pe})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>T(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:os,disabled:!V||!Y||ye,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:ye?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Transfer Rights"]})})]})]})})}),e.jsx("div",{className:"mt-8 flex flex-col items-center space-y-2 text-sm text-gray-600",children:a&&(a.role==="admin"||a.role==="rootadmin")?e.jsxs(e.Fragment,{children:[e.jsx("a",{href:"/admin/terms",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Admin Terms & Conditions"}),e.jsx("a",{href:"/admin/privacy",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Admin Privacy Policy"})]}):e.jsxs(e.Fragment,{children:[e.jsx("a",{href:"/user/terms",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"User Terms & Conditions"}),e.jsx("a",{href:"/user/privacy",className:"text-blue-600 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"User Privacy Policy"})]})}),e.jsx(bs,{})]})}export{Ss as default};
