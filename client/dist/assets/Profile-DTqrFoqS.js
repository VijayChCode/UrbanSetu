import{g as js,M as Ns,k as ks,r as i,u as Ss,ac as U,j as e,U as _e,ad as ee,f as Oe,a4 as Ie,x as ge,z as He,y as c,a3 as As,H as he,G as se,a9 as Be,a8 as We,Q as Ge,L as N,b as Cs,ae as Ps,af as Es,ag as Ds,ah as Ts,ai as O,aj as k,ak as v,al as S,am as ae,q as Ve,an as Us,v as pe,ao as $s,ap as qe,aq as Je}from"./index-CGrQkIao.js";const Fs=["https://api.dicebear.com/7.x/bottts/svg?seed=${name}","https://randomuser.me/api/portraits/men/1.jpg","https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/women/2.jpg","https://randomuser.me/api/portraits/men/3.jpg","https://randomuser.me/api/portraits/women/3.jpg","https://randomuser.me/api/portraits/lego/1.jpg","https://randomuser.me/api/portraits/lego/2.jpg","https://randomuser.me/api/portraits/lego/3.jpg","https://api.dicebear.com/6.x/bottts/svg?seed=avatar0","https://api.dicebear.com/6.x/bottts/svg?seed=avatar1","https://api.dicebear.com/6.x/bottts/svg?seed=avatar2","https://api.dicebear.com/6.x/bottts/svg?seed=avatar3","https://api.dicebear.com/6.x/bottts/svg?seed=avatar4","https://api.dicebear.com/6.x/bottts/svg?seed=avatar5","https://api.dicebear.com/6.x/bottts/svg?seed=avatar6","https://api.dicebear.com/6.x/bottts/svg?seed=avatar7","https://api.dicebear.com/6.x/bottts/svg?seed=avatar8","https://api.dicebear.com/6.x/bottts/svg?seed=avatar9","https://api.dicebear.com/6.x/bottts/svg?seed=avatar10","https://api.dicebear.com/6.x/bottts/svg?seed=avatar11","https://api.dicebear.com/6.x/bottts/svg?seed=avatar12","https://api.dicebear.com/6.x/bottts/svg?seed=avatar13","https://api.dicebear.com/6.x/bottts/svg?seed=avatar14","https://api.dicebear.com/6.x/bottts/svg?seed=avatar15"],Ms={seed:{type:"string"},flip:{type:"boolean",default:!1},rotate:{type:"integer",minimum:0,maximum:360,default:0},scale:{type:"integer",minimum:0,maximum:200,default:100},radius:{type:"integer",minimum:0,maximum:50,default:0},size:{type:"integer",minimum:1},backgroundColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["65c9ff"]},backgroundType:{type:"array",items:{type:"string",enum:["solid","gradientLinear"]},default:["solid"]},backgroundRotation:{type:"array",items:{type:"integer",minimum:-360,maximum:360},default:[0,360]},translateX:{type:"integer",minimum:-100,maximum:100,default:0},translateY:{type:"integer",minimum:-100,maximum:100,default:0},clip:{type:"boolean",default:!0},randomizeIds:{type:"boolean",default:!1},accessories:{type:"array",items:{type:"string",enum:["kurt","prescription01","prescription02","round","sunglasses","wayfarers","eyepatch"]},default:["kurt","prescription01","prescription02","round","sunglasses","wayfarers","eyepatch"]},accessoriesColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffdeb5","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},accessoriesProbability:{type:"integer",minimum:0,maximum:100,default:10},base:{type:"array",items:{type:"string",enum:["default"]},default:["default"]},clothesColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},clothing:{type:"array",items:{type:"string",enum:["blazerAndShirt","blazerAndSweater","collarAndSweater","graphicShirt","hoodie","overall","shirtCrewNeck","shirtScoopNeck","shirtVNeck"]},default:["blazerAndShirt","blazerAndSweater","collarAndSweater","graphicShirt","hoodie","overall","shirtCrewNeck","shirtScoopNeck","shirtVNeck"]},clothingGraphic:{type:"array",items:{type:"string",enum:["bat","bear","cumbia","deer","diamond","hola","pizza","resist","skull","skullOutline"]},default:["bat","bear","cumbia","deer","diamond","hola","pizza","resist","skull","skullOutline"]},eyebrows:{type:"array",items:{type:"string",enum:["angryNatural","defaultNatural","flatNatural","frownNatural","raisedExcitedNatural","sadConcernedNatural","unibrowNatural","upDownNatural","angry","default","raisedExcited","sadConcerned","upDown"]},default:["angryNatural","defaultNatural","flatNatural","frownNatural","raisedExcitedNatural","sadConcernedNatural","unibrowNatural","upDownNatural","angry","default","raisedExcited","sadConcerned","upDown"]},eyes:{type:"array",items:{type:"string",enum:["closed","cry","default","eyeRoll","happy","hearts","side","squint","surprised","winkWacky","wink","xDizzy"]},default:["closed","cry","default","eyeRoll","happy","hearts","side","squint","surprised","winkWacky","wink","xDizzy"]},facialHair:{type:"array",items:{type:"string",enum:["beardLight","beardMajestic","beardMedium","moustacheFancy","moustacheMagnum"]},default:["beardLight","beardMajestic","beardMedium","moustacheFancy","moustacheMagnum"]},facialHairColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["a55728","2c1b18","b58143","d6b370","724133","4a312c","f59797","ecdcbf","c93305","e8e1e1"]},facialHairProbability:{type:"integer",minimum:0,maximum:100,default:10},hairColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["a55728","2c1b18","b58143","d6b370","724133","4a312c","f59797","ecdcbf","c93305","e8e1e1"]},hatColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffdeb5","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},mouth:{type:"array",items:{type:"string",enum:["concerned","default","disbelief","eating","grimace","sad","screamOpen","serious","smile","tongue","twinkle","vomit"]},default:["concerned","default","disbelief","eating","grimace","sad","screamOpen","serious","smile","tongue","twinkle","vomit"]},nose:{type:"array",items:{type:"string",enum:["default"]},default:["default"]},skinColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["614335","d08b5b","ae5d29","edb98a","ffdbb4","fd9841","f8d25c"]},style:{type:"array",items:{type:"string",enum:["circle","default"]},default:["default"]},top:{type:"array",items:{type:"string",enum:["hat","hijab","turban","winterHat1","winterHat02","winterHat03","winterHat04","bob","bun","curly","curvy","dreads","frida","fro","froBand","longButNotTooLong","miaWallace","shavedSides","straight02","straight01","straightAndStrand","dreads01","dreads02","frizzle","shaggy","shaggyMullet","shortCurly","shortFlat","shortRound","shortWaved","sides","theCaesar","theCaesarAndSidePart","bigHair"]},default:["hat","hijab","turban","winterHat1","winterHat02","winterHat03","winterHat04","bob","bun","curly","curvy","dreads","frida","fro","froBand","longButNotTooLong","miaWallace","shavedSides","straight02","straight01","straightAndStrand","dreads01","dreads02","frizzle","shaggy","shaggyMullet","shortCurly","shortFlat","shortRound","shortWaved","sides","theCaesar","theCaesarAndSidePart","bigHair"]},topProbability:{type:"integer",minimum:0,maximum:100,default:100}},te={properties:Ms},d="https://urbansetu.onrender.com",Rs=[{key:"adventurer",label:"Adventurer"},{key:"adventurer-neutral",label:"Adventurer Neutral"},{key:"avataaars",label:"Avataaars"},{key:"avataaars-neutral",label:"Avataaars Neutral"},{key:"big-ears",label:"Big Ears"},{key:"big-ears-neutral",label:"Big Ears Neutral"},{key:"big-smile",label:"Big Smile"},{key:"bottts",label:"Bottts"},{key:"bottts-neutral",label:"Bottts Neutral"},{key:"croodles",label:"Croodles"},{key:"croodles-neutral",label:"Croodles Neutral"},{key:"dylan",label:"Dylan"},{key:"fun-emoji",label:"Fun Emoji"},{key:"glass",label:"Glass"},{key:"icons",label:"Icons"},{key:"identicon",label:"Identicon"},{key:"initials",label:"Initials"},{key:"lorelei",label:"Lorelei"},{key:"lorelei-neutral",label:"Lorelei Neutral"},{key:"micah",label:"Micah"},{key:"miniavs",label:"Miniavs"},{key:"notionists",label:"Notionists"},{key:"notionists-neutral",label:"Notionists Neutral"},{key:"open-peeps",label:"Open Peeps"},{key:"personas",label:"Personas"},{key:"pixel-art",label:"Pixel Art"},{key:"pixel-art-neutral",label:"Pixel Art Neutral"},{key:"rings",label:"Rings"},{key:"shapes",label:"Shapes"},{key:"thumbs",label:"Thumbs"}],zs=["style","seed","flip","rotate"];function Os(){const{currentUser:a,error:Ls}=js(s=>s.user),{wishlist:xe}=Ns(),n=ks(),[u,A]=i.useState({avatar:(a==null?void 0:a.avatar)||""}),[Ye,re]=i.useState(!1),[be,I]=i.useState(""),[p,le]=i.useState(!1),[ie,H]=i.useState({listings:0,appointments:0,wishlist:0}),[ne,B]=i.useState(!1),[ye,Ke]=i.useState([]),[W,Qe]=i.useState(""),[ve,G]=i.useState(!1),[V,we]=i.useState(!1),[Xe,$]=i.useState(!1),[oe,je]=i.useState(""),[Ne,F]=i.useState(""),[Ze,M]=i.useState(!1),[q,ke]=i.useState(""),[Se,J]=i.useState(""),[es,R]=i.useState(!1),[Ae,de]=i.useState([]),[Y,Ce]=i.useState(""),[K,Pe]=i.useState(""),[Ee,C]=i.useState(""),[De,Te]=i.useState(!1),[Q,z]=i.useState(""),[X,P]=i.useState(""),[w,x]=i.useState(!1),[ss,b]=i.useState(!1),[ce,y]=i.useState(""),[Ue,me]=i.useState(""),[f,E]=i.useState({loading:!1,message:"",available:null}),[g,D]=i.useState({loading:!1,message:"",available:null}),[L,as]=i.useState(null),[_,ts]=i.useState(null),[rs,ls]=i.useState(""),[ue,$e]=i.useState(""),h=Ss();window.location.pathname.startsWith("/admin"),i.useEffect(()=>{a&&(ls(a.email||""),$e(a.mobileNumber||""))},[a]),i.useEffect(()=>{a&&is()},[a]),i.useEffect(()=>{a&&H(s=>({...s,wishlist:xe.length}))},[xe,a]),i.useEffect(()=>()=>{L&&clearTimeout(L),_&&clearTimeout(_)},[L,_]);const is=async()=>{try{if(console.log("[fetchUserStats] Fetching stats for:",a),a&&(a.role==="admin"||a.role==="rootadmin")){const[s,t]=await Promise.all([U(`${d}/api/listing/user`),U(`${d}/api/bookings/`)]),l=await s.json(),r=await t.json();H(o=>({listings:Array.isArray(l)?l.filter(m=>m.userRef===a._id).length:0,appointments:Array.isArray(r)?r.length:0,wishlist:o.wishlist}))}else{const[s,t]=await Promise.all([U(`${d}/api/listing/user`),U(`${d}/api/bookings/user/${a._id}`)]),l=await s.json(),r=await t.json();H(o=>({listings:Array.isArray(l)?l.length:0,appointments:Array.isArray(r)?r.length:0,wishlist:o.wishlist}))}}catch(s){console.error("[fetchUserStats] Error fetching user stats:",s),H(t=>({listings:0,appointments:0,wishlist:t.wishlist}))}},Fe=async s=>{if(!s.trim()){E({loading:!1,message:"",available:null});return}if(!s.includes("@")){E({loading:!1,message:"Enter a valid email",available:!1});return}if(s===rs){E({loading:!1,message:"",available:!0});return}try{E({loading:!0,message:"",available:null});const l=await(await U(`${d}/api/user/check-email/${encodeURIComponent(s.trim())}`)).json();E({loading:!1,message:l.message,available:l.available})}catch{E({loading:!1,message:"Error checking email availability",available:!1})}},Me=async s=>{if(!s.trim()){D({loading:!1,message:"",available:null});return}if(!/^[0-9]{10}$/.test(s)){D({loading:!1,message:"Enter a valid 10-digit mobile number",available:!1});return}if(s===ue){D({loading:!1,message:"",available:!0});return}try{D({loading:!0,message:"",available:null});const l=await(await U(`${d}/api/user/check-mobile/${encodeURIComponent(s.trim())}`)).json();D({loading:!1,message:l.message,available:l.available})}catch{D({loading:!1,message:"Error checking mobile availability",available:!1})}},ns=s=>{L&&clearTimeout(L);const t=setTimeout(()=>Fe(s),300);as(t)},os=s=>{_&&clearTimeout(_);const t=setTimeout(()=>Me(s),300);ts(t)},fe=s=>{const{id:t,value:l}=s.target;A({...u,[t]:l}),t==="email"?z(""):t==="mobileNumber"&&P(""),t==="email"?ns(l):t==="mobileNumber"&&os(l)},ds=async s=>{if(s.preventDefault(),I(""),re(!1),z(""),P(""),!u.email||!u.email.trim()){z("Please provide valid email id");return}if(f.available===!1){z("Email already exists. Please use a different one.");return}if(g.available===!1){P("Mobile number already exists. Please use a different one.");return}if(!u.mobileNumber||!/^[0-9]{10}$/.test(u.mobileNumber)){P("Please provide a valid 10-digit mobile number");return}b(!0)},Re=async()=>{if(me(""),!ce){me("Password is required");return}x(!0);try{n(Ds());const s=`${d}/api/user/update/${a._id}`,t=Ts({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,avatar:u.avatar===void 0?"":u.avatar,password:ce})}),r=await(await fetch(s,t)).json();if(console.log("Profile update response:",r),r.status==="email_exists"){c.error("Email already registered. Please use a different one."),z("Email already registered. Please use a different one."),n(O("Email already registered. Please use a different one.")),x(!1),b(!1),y("");return}if(r.status==="mobile_exists"){c.error("Mobile number already in use. Please choose another one."),P("Mobile number already in use. Please choose another one."),n(O("Mobile number already in use. Please choose another one.")),x(!1),b(!1),y("");return}if(r.status==="mobile_invalid"){P("Please provide a valid 10-digit mobile number"),n(O("Please provide a valid 10-digit mobile number")),x(!1),b(!1),y("");return}if(r.status==="invalid_password"){b(!1),y(""),x(!1),c.error("You have been signed out for security reasons. No changes were made to your profile."),n(k());try{const m=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();m.success===!1?n(v(m.message)):(n(S(m)),ae&&ae.purge&&await ae.purge(),Ve(),localStorage.removeItem("accessToken"),document.cookie="access_token=; Max-Age=0; path=/; domain="+window.location.hostname+"; secure; samesite=None")}catch(o){n(v(o.message))}setTimeout(()=>{h("/sign-in",{replace:!0})},800);return}if(r.status==="success"){const o={...r.updatedUser,avatar:r.updatedUser.avatar||"",isGeneratedMobile:r.updatedUser.mobileNumber&&r.updatedUser.mobileNumber!==ue?!1:r.updatedUser.isGeneratedMobile};n(Us(o)),r.updatedUser.mobileNumber&&r.updatedUser.mobileNumber!==ue&&$e(r.updatedUser.mobileNumber),console.log("[Profile] Emitting profileUpdated socket event:",{userId:o._id,username:o.username,avatar:o.avatar,mobileNumber:o.mobileNumber,email:o.email}),console.log("[Profile] Socket connected:",pe.connected),console.log("[Profile] Socket ID:",pe.id),pe.emit("profileUpdated",{userId:o._id,username:o.username,avatar:o.avatar,mobileNumber:o.mobileNumber,email:o.email},m=>{console.log("[Profile] Socket event acknowledgment:",m)}),re(!0),le(!1),x(!1),b(!1),y(""),c.success("Profile Updated Successfully!!"),setTimeout(()=>{re(!1)},3e3);return}if(r.success===!1||r.status==="error"){I(r.message||"Profile Update Failed!"),n(O(r.message)),x(!1),b(!1),y("");return}console.log("Unexpected response:",r),I("Profile Update Failed!"),x(!1),b(!1),y("")}catch(s){console.log("Profile update error:",s),I("Profile Update Failed!"),n(O(s.message)),x(!1),b(!1),y("")}},cs=async()=>{if(a.isDefaultAdmin){B(!0);return}$(!0)},ms=async()=>{if(F(""),!oe){F("Password is required");return}try{n($s());const s=`${d}/api/user/delete/${a._id}`,t={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:oe}),credentials:"include"},l=await fetch(s,t);let r={};try{r=await l.json()}catch{r={}}if(l.status===401){$(!1),c.error("For your security, you've been signed out automatically."),n(k());const m=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();m.success===!1?n(v(m.message)):n(S(m)),h("/sign-in",{replace:!0});return}if(r.message&&r.message.toLowerCase().includes("password")){$(!1),c.error("For your security, you've been signed out automatically."),n(k());const m=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();m.success===!1?n(v(m.message)):n(S(m)),h("/sign-in",{replace:!0});return}if(r.success===!1||l.status!==200){F(r.message||"Account deletion failed"),n(qe(r.message));return}n(Je(r)),$(!1),c.success("Account deleted successfully. Thank you for being with us â€” we hope to serve you again in the future!"),h("/")}catch(s){F("Account deletion failed"),n(qe(s.message))}},us=async()=>{try{G(!0);const s=await fetch(`${d}/api/user/approved-admins/${a._id}`,{credentials:"include"}),t=await s.json();s.ok?Ke(t):c.error(t.message||"Failed to fetch admins")}catch{c.error("Error fetching admins")}finally{G(!1)}},fs=async()=>{if(!W){c.error("Please select an admin to transfer default admin rights to");return}M(!0)},gs=async()=>{if(J(""),!q){J("Password is required");return}try{we(!0);const s=await fetch(`${d}/api/user/verify-password/${a._id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:q})});let t={};try{t=await s.json()}catch{t={}}if(s.status===401){M(!1),c.error("Your session has expired. Please sign in again. No admin rights are Transferred"),n(k());const j=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();j.success===!1?n(v(j.message)):n(S(j)),h("/sign-in",{replace:!0});return}if(!s.ok||t.success===!1){M(!1),c.error("For your security, you've been signed out automatically."),n(k());const j=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();j.success===!1?n(v(j.message)):n(S(j)),h("/sign-in",{replace:!0});return}const l=await fetch(`${d}/api/user/transfer-default-admin`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentAdminId:a._id,newDefaultAdminId:W})}),r=await l.json();if(!l.ok){c.error(r.message||"Failed to transfer default admin rights");return}const o=await fetch(`${d}/api/user/delete/${a._id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:q})}),m=await o.json();if(!o.ok){c.error(m.message||"Failed to delete account after transfer");return}n(Je(m)),B(!1),M(!1),c.success("Admin rights are transferred and account deleted successfully!"),h("/")}catch{J("Account deletion failed")}finally{we(!1)}},hs=async s=>{s.preventDefault();try{n(k());const l=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();l.success===!1?n(v(l.message)):(n(S(l)),await ae.purge(),Ve(),localStorage.removeItem("accessToken"),document.cookie="access_token=; Max-Age=0; path=/; domain="+window.location.hostname+"; secure; samesite=None",c.info("You have been signed out."),await new Promise(r=>setTimeout(r,50)),h("/sign-in",{replace:!0}))}catch(t){n(v(t.message))}},ps=()=>{a&&(a.role==="admin"||a.role==="rootadmin")?h("/admin/my-listings"):h("/user/my-listings")},xs=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});i.useEffect(()=>{ne&&us()},[ne]);const bs=async()=>{try{G(!0);const s=await fetch(`${d}/api/admin/management/admins`,{credentials:"include"}),t=await s.json();s.ok?de(t.filter(l=>l.role==="admin"||l.role==="rootadmin")):de([])}catch{de([])}finally{G(!1)}},ys=()=>{R(!0),C(""),Pe(""),Ce(""),bs()},vs=async()=>{if(C(""),!Y){C("Please select an admin to transfer rights to.");return}if(!K){C("Password is required.");return}Te(!0);try{const s=await fetch(`${d}/api/admin/transfer-rights`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({targetAdminId:Y,password:K})}),t=await s.json();if(s.status===401&&t.error==="invalidPassword"){R(!1),c.error("For your security, you've been signed out automatically."),n(k());const r=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();r.success===!1?n(v(r.message)):n(S(r)),h("/sign-in",{replace:!0});return}if(!s.ok){C(t.message||"Failed to transfer rights.");return}c.success(t.message||"Admin rights transferred successfully!"),R(!1),h("/sign-in",{replace:!0})}catch{C("Failed to transfer rights.")}finally{Te(!1)}};if(i.useEffect(()=>{p&&a&&(A({username:a.username||"",email:a.email||"",mobileNumber:a.mobileNumber?String(a.mobileNumber):"",avatar:a.avatar||""}),a.email&&Fe(a.email),a.mobileNumber&&Me(a.mobileNumber))},[p,a]),i.useEffect(()=>{async function s(){if(a&&a._id)try{console.log("[fetchLatestUser] Fetching user data for:",a._id);const t=await fetch(`${d}/api/user/id/${a._id}`);if(t.ok){const l=await t.json();console.log("[fetchLatestUser] Got user:",l),n({type:"user/signInSuccess",payload:l})}else console.error("[fetchLatestUser] Failed to fetch user")}catch(t){console.error("[fetchLatestUser] Error:",t)}}s()},[]),!a||!a.username||!a.email)return e.jsx("div",{className:"text-center text-red-600 mt-10",children:"Profile data is missing or could not be loaded. Please refresh or sign in again."});if(w&&!p)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading profile..."})]})});i.useEffect(()=>{p&&w&&x(!1)},[p,w]);const ws=s=>{const t=s.target.files[0];if(!t)return;const l=new FileReader;l.onload=r=>{A(o=>({...o,avatar:r.target.result}))},l.readAsDataURL(t)},[T,Z]=i.useState({style:"avataaars",filters:{}}),ze=()=>{const s=`https://api.dicebear.com/9.x/${T.style}/svg`,t=Object.entries(T.filters).filter(([l,r])=>r!=null&&r!==""&&!(Array.isArray(r)&&r.length===0)).map(([l,r])=>Array.isArray(r)?`${l}=${r.join(",")}`:typeof r=="boolean"?`${l}=${r}`:`${l}=${encodeURIComponent(r)}`).join("&");return t?`${s}?${t}`:s};return e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:space-x-6 w-full text-center sm:text-left mb-4 md:mb-0",children:[e.jsxs("div",{className:"relative flex-shrink-0 mx-auto sm:mx-0",children:[e.jsx(_e,{user:a,size:"h-24 w-24",textSize:"text-2xl"}),a.role==="admin"&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-purple-500 text-white rounded-full p-2",children:e.jsx(ee,{className:"w-4 h-4"})}),a.isDefaultAdmin&&e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-red-500 text-white rounded-full p-2",children:e.jsx(ee,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 w-full",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 flex flex-wrap items-center justify-center sm:justify-start",children:[a.username,a.role==="admin"&&e.jsx("span",{className:"ml-2 bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded-full font-medium",children:"Admin"}),a.isDefaultAdmin&&e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-sm px-3 py-1 rounded-full font-medium",children:"Default Admin"})]}),e.jsxs("p",{className:"text-gray-600 flex flex-wrap items-center justify-center sm:justify-start break-all",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),a.email]}),e.jsxs("p",{className:"text-gray-600 flex flex-wrap items-center justify-center sm:justify-start break-all",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),a.mobileNumber&&a.mobileNumber!=="0000000000"?`+91 ${a.mobileNumber.slice(0,5)} ${a.mobileNumber.slice(5)}`:"Mobile number not provided",a.isGeneratedMobile&&e.jsx("span",{className:"text-xs text-gray-400 ml-2",children:"(Generated for Google signup)"})]}),e.jsxs("p",{className:"text-sm text-gray-500 text-center sm:text-left mt-1",children:["Member since ",xs(a.createdAt)]})]})]}),e.jsxs("button",{onClick:()=>le(!p),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-1 sm:gap-2 text-sm sm:text-base w-full sm:w-auto justify-center",children:[e.jsx(ge,{className:"w-4 h-4"}),p?"Cancel Edit":"Edit Profile"]})]})}),p&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2 text-blue-600"}),"Edit Profile Information"]}),e.jsxs("form",{onSubmit:ds,className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"mb-2",children:e.jsx(_e,{user:{...a,avatar:u.avatar},size:"w-24 h-24",textSize:"text-2xl"})}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center mt-2",children:[Fs.map((s,t)=>e.jsx("button",{type:"button",onClick:()=>A({...u,avatar:s}),className:`w-12 h-12 rounded-full border-2 ${u.avatar===s?"border-blue-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-400`,children:e.jsx("img",{src:s,alt:`Avatar ${t+1}`,className:"w-full h-full rounded-full object-cover"})},s)),e.jsxs("label",{className:"w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center cursor-pointer bg-gray-100 hover:bg-gray-200",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:ws}),e.jsx(ge,{className:"text-gray-500"})]}),e.jsx("button",{type:"button",onClick:()=>A({...u,avatar:""}),className:"w-12 h-12 rounded-full border-2 border-red-400 flex items-center justify-center bg-red-50 hover:bg-red-100",children:e.jsx(He,{className:"text-red-500"})})]}),e.jsxs("div",{className:"mt-4 w-full flex flex-col items-center",children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-2",children:"Or create a custom DiceBear avatar:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center w-full",children:[e.jsx("label",{className:"font-medium text-sm",children:"Style:"}),e.jsx("select",{className:"border p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",value:T.style,onChange:s=>{Z({style:s.target.value,filters:{}})},children:Rs.map(s=>e.jsx("option",{value:s.key,children:s.label},s.key))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2 w-full max-w-2xl",children:[zs.map(s=>!te.properties[s]||s==="style"?null:s==="seed"?e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("label",{className:"text-xs font-medium mb-1",children:s}),e.jsx("input",{type:"text",className:"border p-2 rounded-lg",value:T.filters[s]||"",onChange:l=>Z(r=>({...r,filters:{...r.filters,[s]:l.target.value}})),placeholder:"Enter a name or keyword (e.g. John, robot, flower...)"})]},s):null),e.jsxs("div",{className:"flex items-end gap-6 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs font-medium",children:"flip"}),e.jsx("input",{type:"checkbox",checked:!!T.filters.flip,onChange:s=>Z(t=>({...t,filters:{...t.filters,flip:s.target.checked}}))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-medium mb-1",children:"rotate"}),e.jsx("input",{type:"number",className:"border p-2 rounded-lg w-24",value:T.filters.rotate??te.properties.rotate.default??"",min:te.properties.rotate.minimum,max:te.properties.rotate.maximum,onChange:s=>Z(t=>({...t,filters:{...t.filters,rotate:s.target.value===""?void 0:Number(s.target.value)}}))})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsx("img",{src:ze(),alt:"DiceBear Avatar Preview",className:"w-24 h-24 rounded-full border-2 border-blue-300 shadow"}),e.jsx("button",{type:"button",className:"mt-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all font-semibold",onClick:async()=>{const s=ze();A({...u,avatar:s});try{const l=await(await fetch(`${d}/api/user/${a._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({avatar:s})})).json();l.status==="success"?c.success("Avatar updated!"):l.status==="error"&&c.error(l.message||"Failed to update avatar.")}catch{c.error("Failed to update avatar.")}},children:"Use this avatar"})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"Note: Please upload a profile image below 75KB only for best performance."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(As,{className:"w-4 h-4 mr-2"}),"Username"]}),e.jsx("input",{type:"text",id:"username",placeholder:"Enter username",value:u.username||"",onChange:fe,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Email Address"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",id:"email",placeholder:"Enter email address",value:u.email||"",onChange:fe,className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${f.available===!1?"border-red-500 focus:ring-red-500":f.available===!0?"border-green-500 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`}),f.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),f.available===!0&&!f.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(he,{className:"h-5 w-5 text-green-500"})}),f.available===!1&&!f.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(se,{className:"h-5 w-5 text-red-500"})})]}),Q&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Q}),f.message&&!Q&&e.jsx("div",{className:`text-sm mt-1 ${f.available===!0?"text-green-600":f.available===!1?"text-red-600":"text-gray-600"}`,children:f.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Mobile Number"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"tel",id:"mobileNumber",placeholder:"Enter 10-digit mobile number",value:u.mobileNumber||"",onChange:fe,pattern:"[0-9]{10}",maxLength:"10",className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${g.available===!1?"border-red-500 focus:ring-red-500":g.available===!0?"border-green-500 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`}),g.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),g.available===!0&&!g.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(he,{className:"h-5 w-5 text-green-500"})}),g.available===!1&&!g.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(se,{className:"h-5 w-5 text-red-500"})})]}),X&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:X}),g.message&&!X&&e.jsx("div",{className:`text-sm mt-1 ${g.available===!0?"text-green-600":g.available===!1?"text-red-600":"text-gray-600"}`,children:g.message})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>le(!1),className:"bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2",children:"Cancel"}),e.jsx("button",{type:"submit",className:`bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2 ${w||f.loading||g.loading||f.available===!1||g.available===!1?"opacity-60 cursor-not-allowed transform-none":""}`,disabled:w||f.loading||g.loading||f.available===!1||g.available===!1,children:w?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Saving..."]}):"Save Changes"})]}),be&&!Q&&!X&&e.jsx("div",{className:"text-red-600 text-sm mt-3",children:be})]})]}),!p&&Ye&&e.jsx("div",{className:"text-green-600 text-sm mb-6",children:"Profile updated successfully!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Be,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:ie.listings}),e.jsx("p",{className:"text-gray-600",children:"My Listings"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(We,{className:"w-6 h-6 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:ie.appointments}),e.jsx("p",{className:"text-gray-600",children:"Appointments"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-red-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ge,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:ie.wishlist}),e.jsx("p",{className:"text-gray-600",children:"Wishlist Items"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[e.jsxs("button",{onClick:ps,className:"bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition-colors flex flex-col items-center",children:[e.jsx(Be,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"My Listings"})]}),e.jsxs(N,{to:a.role==="admin"||a.role==="rootadmin"?"/admin/appointments":"/user/my-appointments",className:"bg-green-500 text-white p-3 rounded-lg hover:bg-green-600 transition-colors flex flex-col items-center",children:[e.jsx(We,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:a.role==="admin"||a.role==="rootadmin"?"Appointments":"My Appointments"})]}),e.jsxs(N,{to:a.role==="admin"||a.role==="rootadmin"?"/admin/wishlist":"/user/wishlist",className:"bg-red-500 text-white p-3 rounded-lg hover:bg-red-600 transition-colors flex flex-col items-center",children:[e.jsx(Ge,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"My Wishlist"})]}),e.jsxs(N,{to:a.role==="admin"||a.role==="rootadmin"?"/admin/reviews":"/user/reviews",className:"bg-yellow-500 text-white p-3 rounded-lg hover:bg-yellow-600 transition-colors flex flex-col items-center",children:[e.jsx(Cs,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:a.role==="admin"||a.role==="rootadmin"?"Reviews":"My Reviews"})]}),e.jsxs("button",{onClick:()=>h(a.role==="admin"||a.role==="rootadmin"?"/admin/change-password":"/user/change-password"),className:"bg-purple-500 text-white p-3 rounded-lg hover:bg-purple-600 transition-colors flex flex-col items-center cursor-pointer",children:[e.jsx(Ps,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"font-medium text-sm",children:"Change Password"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Account Management"}),(a.role==="admin"||a.role==="rootadmin")&&e.jsx("button",{onClick:()=>h("/admin/management"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg mb-6 hover:bg-blue-700 transition-colors flex items-center justify-center font-semibold",children:"Accounts"}),a.isDefaultAdmin&&e.jsxs("button",{onClick:ys,className:"bg-yellow-500 text-white px-6 py-3 rounded-lg mb-6 hover:bg-yellow-600 transition-colors flex items-center justify-center font-semibold",style:{marginBottom:16},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Transfer Rights"]}),a.isDefaultAdmin&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-blue-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-2",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Note:"})," You must transfer your default admin rights to another admin before you can delete your account."]})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:hs,className:"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors flex items-center justify-center",children:[e.jsx(Es,{className:"w-4 h-4 mr-2"}),"Sign Out"]}),e.jsxs("button",{onClick:cs,className:"bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Delete Account"]})]})]})]}),ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Default Admin Rights"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"As the default admin, you must select another approved admin to transfer your default admin rights before deleting your account."}),ve?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):ye.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other approved admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot delete your account until another admin is approved."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:W,onChange:s=>Qe(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose an admin..."}),ye.map(s=>e.jsxs("option",{value:s._id,children:[s.username," (",s.email,")"]},s._id))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>B(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:fs,disabled:!W||V,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:V?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Transfer & Delete"]})})]})]})})}),Xe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm account deletion. This action cannot be undone."}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),ms()},children:[e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your password",value:oe,onChange:s=>je(s.target.value)}),Ne&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:Ne}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{$(!1),je(""),F("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:"Delete"})]})]})]})})}),Ze&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm account deletion after transferring default admin rights. This action cannot be undone."}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),gs()},children:[e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your password",value:q,onChange:s=>ke(s.target.value)}),Se&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:Se}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{M(!1),ke(""),J("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",disabled:V,children:V?"Processing...":"Transfer & Delete"})]})]})]})})}),ss&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Profile Update"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm the profile changes."}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password",value:ce,onChange:s=>y(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),Re())}}),Ue&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:Ue}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{b(!1),y(""),me("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Re,disabled:w,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Profile"})]})]})})}),es&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Root Admin Rights"}),e.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Select an admin to transfer your root admin rights. You will remain an admin after transfer."}),ve?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Ae.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot transfer rights until another admin exists."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:Y,onChange:s=>Ce(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose an admin..."}),Ae.map(s=>e.jsxs("option",{value:s._id,children:[s.username," (",s.email,")"]},s._id))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password:"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),vs()},children:[e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500",placeholder:"Enter your password",value:K,onChange:s=>Pe(s.target.value)}),Ee&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:Ee}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>R(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!Y||!K||De,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:De?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Transfer Rights"]})})]})]})]})]})})}),e.jsx("div",{className:"mt-8 flex flex-col items-center space-y-2 text-sm text-gray-600",children:a&&(a.role==="admin"||a.role==="rootadmin")?e.jsxs(e.Fragment,{children:[e.jsx(N,{to:"/admin/terms",className:"text-blue-600 hover:underline",children:"Admin Terms & Conditions"}),e.jsx(N,{to:"/admin/privacy",className:"text-blue-600 hover:underline",children:"Admin Privacy Policy"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{to:"/user/terms",className:"text-blue-600 hover:underline",children:"User Terms & Conditions"}),e.jsx(N,{to:"/user/privacy",className:"text-blue-600 hover:underline",children:"User Privacy Policy"})]})})]})}export{Os as default};
